---
params:
  boj: 10122
  bojTitle: Hotels
---

## 문제 내용

$n$개의 정점을 갖는 무방향 무가중치 트리가 주어집니다. 두 정점 사이의 거리는 두 정점 사이의 최단 경로에 포함되는 간선의 개수로 정의합니다. 세 정점을 골라서 셋 중 어느 두 정점을 골라도 거리가 서로 같게 하는 방법의 수를 구하세요.

### 입력

첫 줄에는 정점의 개수 $n$이 주어집니다. ($1 \le n \le 5000$)

다음 $n-1$줄에는 트리의 간선의 목록이 한 줄에 하나씩 주어집니다. 각 간선은 그 간선이 잇는 두 정점의 번호 $a$와 $b$로 주어집니다. ($1 \le a < b \le n$)

### 출력

문제의 정답을 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

세 정점이 서로 같은 거리에 있을 조건은 다음과 같이 바꿀 수 있습니다.

* 두 정점 간의 거리가 홀수일 수는 없습니다. 세 개의 최단 경로를 모으면 그 경로들에 포함되는 간선은 모두 두 번씩 세어지기 때문입니다.
* 그러한 거리가 $2d$일 때, 세 정점은 제4의 정점 $X$로부터 정확히 $d$만큼씩 떨어져 있습니다.
* 트리에서 정점 $X$를 제거했을 때, 두 정점이 같은 연결 요소에 있으면 그 둘 사이의 거리는 $2d$보다 작게 되므로, 세 정점은 모두 서로 다른 연결 요소에 포함되어야 합니다.

따라서, 각 정점 $X$를 루트로 했을 때, $X$로 나누어지는 서브트리들에서 깊이 $d$인 정점들의 개수를 따로따로 센 뒤에, 그 중 서로 다른 서브트리에 해당하는 3개의 값의 곱들의 합을 구하면 됩니다.
각 서브트리의 각 깊이의 정점의 수를 셀 때는, 트리DP를 할 필요 없이 각 정점에서 그래프 탐색을 해 가면서 구하면 $\mathcal{O}(n^2)$에 구할 수 있으므로 시간적으로는 문제가 없습니다.

이제 문제는 수열 $x_1, x_2, \cdots, x_m$이 있을 때 $\sum_{1 \le i < j < k \le m} {x_i x_j x_k}$를 구하는 것입니다. 이를 $\mathcal{O}(m)$에 구하는 방법은 여러 가지가 있을 수 있는데, 한 가지 방법은 다음과 같습니다.

* 먼저 $a_1 = \sum x_i$, $a_2 = \sum x_i^2$, $a_3 = \sum x_i^3$을 구합니다.
* 그러면 답은 $\frac{a_1^3 - 3 a_1 a_2 + 2 a_3}{6}$입니다.

{{< /details >}}
