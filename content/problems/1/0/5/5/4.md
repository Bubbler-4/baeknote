---
params:
  boj: 10554
  bojTitle: COCI
---

## 문제 내용

COCI는 3개의 라운드로 이루어집니다. 2개의 라운드가 이미 종료되었으며, 각 참가자의 두 라운드에서의 점수가 주어집니다.
다음의 예상에 따라 3번째 라운드 이후 모든 참가자의 순위를 예측해보려고 합니다.

* 참가자 A가 참가자 B보다 1라운드와 2라운드 모두에서 strictly 더 좋은 점수를 받았다면, 3라운드에서도 A는 적어도 B 이상의 점수를 받을 것이다.

참가자의 순위는 세 라운드에서의 점수의 총점을 기준으로 매겨집니다. 같은 점수를 가진 참가자가 여러 명이라면, 그 점수를 가진 모든 참가자는 동일한 순위가 됩니다.
구체적으로, 어떤 참가자의 순위의 값은 `(이 참가자보다 strictly 더 좋은 점수를 받은 참가자의 수) + 1`과 같습니다.

모든 라운드에서 각 참가자의 점수는 0점 이상 650점 이하입니다. 이때, 각 참가자에 대해 3라운드가 끝난 후 그 참가자가 가질 수 있는 가장 높은 순위와 가장 낮은 순위를 계산하여 출력하세요.

### 입력

첫 줄에 참가자의 수 $N$이 주어집니다. (1 \le N \le 500\;000$)

다음 $N$줄에 걸쳐서, 각 참가자의 1라운드와 2라운드 점수가 한 줄에 주어집니다. 각 점수는 0 이상 650 이하의 정수입니다.

### 출력

각 참가자에 대해, 그 참가자가 가질 수 있는 가장 높은 순위와 가장 낮은 순위를 순서대로 한 줄에 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

참가자 A가 참가자 B보다 1라운드와 2라운드 모두에서 더 높은 점수를 받았을 때, A가 B보다 *잘한다*, B가 A보다 *못한다*고 하겠습니다. 또한, A가 B보다 잘하거나 못하지 않는다면 *관계가 없다*고 하겠습니다.

한 참가자 X가 가질 수 있는 가장 높은 순위는 다음의 경우에 의해 결정됩니다.

* X가 만점을 받습니다. X보다 잘하는 모든 참가자들도 자동으로 만점을 받습니다. 그 외의 모든 참가자는 0점을 받습니다.

X보다 잘하는 모든 참가자는 자동으로 최종 점수가 X보다 높게 됩니다. 그 외의 참가자는 X보다 최종 점수가 높을 수 없습니다. 서로 관계가 없는 두 참가자가 가질 수 있는 2라운드까지의 점수의 차이는 정확히 650점이기
때문입니다. 이러한 경우는 한 라운드에서 한 명은 0점, 다른 한 명은 650점을 받고, 다른 라운드에서는 동점을 기록한 경우입니다.

따라서, 1라운드 점수에 대해 정렬한 후 2라운드 점수별 사람 수를 유지하는 세그먼트 트리를 사용하거나, 1라운드 점수별로 스위핑을 하여 X보다 잘하는 사람의 수를 세어 이 경우를 해결할 수 있습니다.

한 참가자 X가 가질 수 있는 가장 낮은 순위는 다음의 경우에 의해 결정됩니다.

* X가 0점을 받습니다. X보다 못하는 모든 참가자들도 자동으로 0점을 받습니다. 그 외의 모든 참가자는 만점을 받습니다.

이 경우, 앞의 경우와 동일하게 먼저 X보다 못하는 참가자의 수를 세어 줍니다.

그런데 X와 관계가 없지만 정확히 650점이 낮은 Y가 존재한다면, X의 최저 순위는 그러한 Y의 수만큼 올라갑니다. 이를 처리하기 위해,
두 점수가 $(a, 0)$인 참가자의 수와 $(0, b)$인 참가자의 수를 미리 세어놓은 뒤에, X의 점수가 $(a, 650)$이거나 $(650, b)$일 경우 X의 순위 값에서 그만큼을 빼 주면 됩니다.

{{< /details >}}
