---
params:
  boj: 11499
  bojTitle: Path
---

## 문제 내용

히스토그램 모양의 다각형이 주어집니다. 다각형의 꼭짓점의 순서는 항상 맨 왼쪽 아래의 점에서 시작하여 반시계 방향 순서로 주어집니다.

이 다각형의 테두리 위에 여러 개의 점이 주어집니다. 각 점은 (다각형의 꼭짓점 번호 $k$, 추가 이동 거리 $d$)로 주어지며, 해당 꼭짓점에서 다각형 테두리 위의 반시계 방향으로 이동 거리만큼 이동한 점을 의미합니다.
맨 왼쪽 아래의 점에서 시작하여 다각형의 내부만을 통과하여 각 점에 도달하는 최단 경로의 길이들의 합을 출력하세요.

### 입력

첫 줄에는 테스트 케이스의 개수 $T$가 주어집니다.

각 테스트 케이스에 대해, 첫 줄에는 히스토그램의 꼭짓점의 개수 $n$이 주어지고, 그 다음 줄부터 $n$줄에 걸쳐 각 꼭짓점의 좌표가 주어집니다. ($4 \le n \le 100\;000$, $0 \le x, y \le 1\;000\;000$)

그 다음 줄에는 거리를 구해야 하는 점의 개수 $m$이 주어지고, 그 다음 줄부터 $m$줄에 걸쳐서 $(k, d)$의 쌍이 주어집니다. ($0 \le k \le n-1$, $0 \le d < |v_k - v_{k+1}|$)

모든 입력값은 정수입니다.

### 출력

각 테스트 케이스에 대해, 모든 점까지의 거리의 합을 반올림하여 소수점 첫째 자리까지 출력합니다. 정답과 오차가 0.1 이하이면 정답으로 인정됩니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

둘레를 따라가는 순서를 반대로 생각하면, 둘레를 따라 목적지가 움직일 때 최단 경로는 아래쪽 볼록껍질이 변화하는 방식과 동일한 방식으로 계산됨을 알 수 있습니다.

따라서, 모노톤 체인 구현을 그대로 따라가면서, 현재 체인의 길이의 총합을 유지하여 원하는 점에서의 길이들을 모두 더해서 정답을 얻을 수 있습니다.

{{< /details >}}
