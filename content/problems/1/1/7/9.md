---
params:
  boj: 1179
  bojTitle: 마지막 요세푸스 문제
---

## 문제 내용

1번부터 $N$번까지 $N$명의 사람들이 원을 이루면서 번호 순서대로 앉아있는 상태에서 시작하여, 1번부터 시작하여 $K$번째 사람을 원에서 제거하는 것을 반복하였을 때 최종적으로 원에 남아있는 사람의 번호를 구하세요. ($1 \le N \le 10^{15}, 1 \le K \le 90$)

## 문제 풀이

{{% details title="스포일러" closed="true" %}}

$K > 1$, $N > K$라고 가정합니다. $K = 1$이면 정답은 $N$이고, $N \le K$이면 시뮬레이션으로 풀 수 있습니다.

$N$이 크므로, $K, 2K, \cdots$번 사람들을 한꺼번에 제거할 수 있습니다. 가능한 한 많은 사람들을 이 방법으로 제거하고 남는 사람의 수는 $N' = N - \lfloor \frac{N}{K} \rfloor$ 입니다. 이제 $N'$명에 대한 요세푸스 문제의 답을 $a$라고 합시다.

만약 $a \le N \bmod K$이면, 원래 문제에서 살아남은 사람은 첫 단계에서 마지막으로 제거된 사람의 오른쪽에 있으며, 그 번호는 $N - N \bmod K + a$입니다.

아니라면, 살아남은 사람은 첫 단계에서 살아남은 사람 중 왼쪽에서 $a - N \bmod K$번째에 있는 사람이며, $K-1$명짜리 그룹이 왼쪽에 몇 개가 있는지를 이용하여 왼쪽에서 제거된 사람의 수를 구해서 원래 몇 번이었는지를 구할 수 있습니다.

이 전체 과정을 재귀로 구현하면, 재귀 깊이는 $\log_{\frac{90}{89}} {10^{15}} \approx 3000$ 정도가 되어 충분히 빠른 시간 내에 해결됩니다.

{{% /details %}}
