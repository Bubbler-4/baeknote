---
params:
  boj: 12822
  bojTitle: Wall
---

## 문제 내용

매우 큰 벽에 $N$개의 구멍이 있어 로봇을 이용하여 보수 공사를 하려고 합니다. 현재 로봇의 위치는 $P$입니다.

$i$번째 구멍의 위치는 $X_i$이고, 공사 시작 시점을 기준으로 $t$시간 이후에 이 구멍을 막는 데는 $C_i + D_i t$의 비용이 소모됩니다.
로봇이 위치 $a$에서 위치 $b$로 이동하는 데는 $|a-b|$의 시간이 들며, 구멍을 막는 데는 시간이 들지 않습니다.

이 로봇을 이용하여 모든 구멍을 막는 데 필요한 총 비용의 최솟값을 구하세요.

### 입력

첫 줄에는 $N$과 $P$가 주어집니다. ($1 \le N \le 2000$, $0 \le P \le 10^9$)

다음 $N$줄에 걸쳐서, $i$번째 줄에는 $i$번째 구멍에 대한 세 개의 값 $X_i$, $C_i$, $D_i$가 주어집니다.
($0 \le X_i \le 10^9$, $0 \le C_i, D_i \le 10^6$, $X_i \neq P$) 모든 구멍의 위치는 서로 다르며, 로봇의 시작 지점과도 다릅니다.

## 문제 풀이

{{% details title="스포일러" closed="true" %}}

먼저, $C_i$는 구멍들을 어느 순서로 방문하든 고정이므로 고려하지 않고, 맨 마지막에 그 합을 더해 줍니다.

로봇이 한 방향으로 계속 이동할 경우 그 경로상의 모든 구멍을 막고 지나가는 것이 항상 이득이므로, 막힌 구멍의 영역은 하나의 구간을 이룬다고 볼 수 있습니다. 따라서 구간 DP를 생각해 봅니다.

로봇의 최적의 이동은 구간을 한 칸씩 확장하는 방향으로 이루어지며, 그 때 마지막으로 방문한 구멍은 구간의 양 끝 중 하나입니다.
그리고 로봇이 $t$초 동안 이동한다고 하면 아직 방문하지 않은 모든 구멍의 $D_i$의 합에 $t$를 곱한 만큼을 "확정된 비용"으로 볼 수 있습니다. 따라서 이 "확정된 비용"을 DP로 구해주면 됩니다. 구간 밖의 $D_i$의 합은 prefix/suffix sum을 미리 구해놓으면 그 중 두 개의 값의 합으로 구할 수 있습니다.

{{% /details %}}
