---
params:
  boj: 13341
  bojTitle: 두 트리
---

## 문제 내용

생략

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

이 문제는 min-cut 모델링, 그 중에서 [binary string modeling](https://codeforces.com/blog/entry/136761)으로 풀 수 있습니다.

이 모델링은 다음의 문제를 다룹니다.

* $n$개의 칸에 0이나 1을 적었을 때 다음의 상황에 각각 페널티가 발생한다. (각 페널티는 음이 아닌 수이다.) 이때 페널티의 총합을 최소화하시오.
  * $a_i = 0$이면 $A_i$ 페널티
  * $a_i = 1$이면 $B_i$ 페널티
  * $a_i = 1$이고 $a_j = 0$이면 $C_{ij}$ 페널티

이 문제에 대한 min-cut 모델링은 다음과 같습니다.

* source $s$를 1로 두고, sink $t$를 0으로 둡니다.
* $a_i = 0$이면 source와 단절되므로 $A_i$ 용량의 $s \rightarrow i$ 간선을 만듭니다.
* $a_i = 1$이면 sink와 단절되므로 $B_i$ 용량의 $i \rightarrow t$ 간선을 만듭니다.
* $a_i = 1$이고 $a_j = 0$이면 $i$에서 $j$ 방향으로 단절되므로 $C_{ij}$ 용량의 $i \rightarrow j$ 간선을 만듭니다.

이렇게 모델링한 뒤 maximum flow를 구하면 max-flow min-cut theorem에 의해 최소 페널티의 값이 됩니다.

이제 이 문제에 binary string modeling을 적용하면 다음과 같습니다.

* 집합에 포함된 노드를 1, 포함되지 않은 노드를 0으로 둡니다.
* $s_i < 0$이면, 이 노드를 포함했을 때 $-s_i$의 페널티가 발생합니다.
* $s_i > 0$이면, 이 노드를 제외했을 때 $s_i$의 페널티가 발생합니다.
* 어떤 루트를 잡고 루트를 포함하는 집합을 찾는다고 하면, $i$가 $j$의 자식일 경우 $i$를 포함하고 $j$를 제외하면 안됩니다. 이러한 조건에 대해서는 $\infty$의 페널티를 줄 수 있습니다.

이러한 모델링을 모든 가능한 루트에 대해 시도해보고 그 중 최적인 것을 고르면 됩니다. 정답은 $s_i > 0$인 $s_i$들의 합에서 최소 페널티를 뺀 것과 같습니다.

{{< /details >}}
