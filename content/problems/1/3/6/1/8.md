---
params:
  boj: 13618
  bojTitle: RSA
---

## 문제 내용

RSA 암호화 알고리즘은 다음과 같은 절차로 키를 생성합니다:

- 두 개의 홀수 소수 $P$와 $Q$를 선택하고 $N = PQ$를 계산합니다.
- 오일러 피 함수 $\phi(N) = (P - 1)(Q - 1)$을 계산하고, $\phi(N)$과 서로소이면서 $1 < E < \phi(N)$을 만족하는 정수 $E$를 선택합니다.
- $\phi(N)$에 대한 $E$의 모듈러 역원, 즉 $D$를 계산하여 $DE \equiv 1 \mod \phi(N)$을 만족하는 정수 $D$를 구합니다.

이를 통해 공개키 $(N, E)$와 비밀키 $(N, D)$를 얻을 수 있습니다.

$0 < M < N$을 만족하는 메시지 $M$은 $C = M^E \mod N$으로 암호화됩니다.  
암호문 $C$로부터 원래의 메시지를 복호화하려면 $M = C^D \mod N$을 계산하면 됩니다.

RSA 암호를 해독하는 프로그램을 작성하세요.

### 입력

세 정수 $N$, $E$, $C$가 입력으로 주어집니다. ($15 \le N \le 10^9$, $1 \le E < N$, $1 \le C < N$)

여기서 $N$과 $E$는 공개키, $C$는 공개키로 암호화된 메시지입니다.

### 출력

원래 메시지인 정수 M를 출력합니다. ($1 \le M < N$)

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

RSA 해독을 위해서는 비밀키 $D$를 구해야 합니다. $D$는 $E$의 모듈러 역원으로, $\phi(N) = (P-1)(Q-1)$에 대해 $DE \equiv 1 \mod \phi(N)$을 만족합니다.  
문제에서는 $N \le 10^9$이므로 $N$의 소인수분해 $(P, Q)$를 통해 $\phi(N)$을 계산하고,  
`Extended Euclidean Algorithm`을 사용하여 $D$를 계산한 뒤, $M = C^D \mod N$으로 복호화할 수 있습니다.

예시 pseudocode:

```text
1. N을 소인수분해하여 P, Q를 찾는다.
2. φ = (P-1)*(Q-1)
3. D = modular_inverse(E, φ) // pow(E, -1, φ)
4. M = pow(C, D, N)
5. M 출력
```

{{< /details >}}
