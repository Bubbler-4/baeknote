---
params:
  boj: 14120
  bojTitle: Banane
---

## 문제 내용

무한한 사각 격자의 몇몇 칸이 검은색으로 칠해져 있습니다. 나머지 칸은 흰색입니다. 어떤 흰색 칸에 말을 상하좌우 중 한 방향을 보도록 놓으면, 그 말은 지문의 그림과 같이 우회전 나선 방향으로 움직입니다.

이때, 말이 최소 이동으로 모든 검은 칸을 밟게 되는 경우를 찾아서, 그때의 이동 횟수를 출력하세요.

### 입력

첫 줄에는 검은 칸의 개수 $N$이 주어집니다. ($1 \le N \le 100\;000$)

다음 $N$줄에는 검은 칸의 $x$, $y$ 좌표가 주어집니다. ($0 \le x, y \le 10^8$)

주어지는 좌표들은 모두 다릅니다.

### 출력

문제의 정답을 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

일단, 말이 밟게 되는 칸의 영역은 시작점을 중심으로 한 정사각형 영역에 다음 "층"의 몇 칸을 추가한 형태입니다. 정사각형의 한 변의 길이가 길어지면 이동 횟수는 무조건 많아지므로, 먼저 정사각형의 크기를 최소화해야 합니다.

말이 마지막으로 밟게 될 검은 칸은 맨 위 중에서 맨 오른쪽, 맨 오른쪽 중에서 맨 아래, 맨 아래 중에서 맨 왼쪽, 맨 왼쪽 중에서 맨 위 칸의 4개 중 하나입니다. 따라서 먼저 이들의 좌표를 계산해 놓으면,
정사각형의 중심이 주어졌을 때 정사각형의 한 변의 길이와 추가적으로 밟아야 할 칸의 개수를 계산할 수 있습니다.

$x$좌표의 범위와 $y$좌표의 범위 중에서 하나가 크다면, 네 점 모두를 덮는 최소 정사각형의 중심은 어떤 직사각형 영역 내에 있습니다. 이들 중심 중에서 흰색 칸이 있다면 그러한 칸들에 대해 답을 계산해 보고 최소를 출력하면 됩니다.
흰색 칸이 없다면, 정사각형의 크기를 1씩 늘리는 것을 고려합니다. 그러면 중심이 속하는 영역이 사방으로 1칸씩 확장됩니다. 이 과정은 그 영역의 넓이가 $N$을 초과할 때 반드시 멈추므로, **한 가지 경우를 제외하고** 문제없이 시간 내에 답을 냅니다.

문제가 되는 경우는, $x$로 극단적으로 좁고 $y$로 극단적으로 넓거나 그 반대인 경우입니다. 좌표의 범위가 1억이므로, 최초의 중심의 범위의 한 쪽 길이가 대략 1억이 되며, 이 점들을 모두 시도한다면 TLE를 받습니다.
이를 회피하기 위해서는 최적의 중심의 위치가 직사각형의 양 끝 근처에 있다는 관찰을 하여 시도 횟수를 줄여야 합니다.

{{< /details >}}
