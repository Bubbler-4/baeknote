---
params:
  boj: 14518
  bojTitle: Ili
---

## 문제 내용

$n$개의 입력과 $m$개의 이진 OR 게이트로 이루어진 회로가 주어집니다. 각 OR 게이트의 출력값 중 일부를 알 때, 모든 OR 게이트의 출력값들 중에서 확실히 알 수 있는 것들을 모두 찾아 그 값을 출력하세요.

### 입력

첫 줄에는 $n$과 $m$이 주어집니다. ($1 \le n, m \le 10\;000$)

다음 줄에는 `0`, `1`, `?`로만 이루어진 길이 $m$의 문자열이 주어집니다. 이 문자열의 $i$번째 글자가 `0` 또는 `1`이면 $i$번 OR 게이트의 출력값이 각각 0 또는 1임을, `?`는 그 게이트의 출력값이 주어지지 않았음을 의미합니다.

그 다음 $m$줄에는 각각의 OR 게이트의 두 개의 입력이 주어집니다. `xA`이면 $A$번 입력, `cA`이면 $A$번 OR 게이트의 출력을 의미합니다.

주어지는 회로에는 사이클이 없고, $i$번 게이트의 출력이 $j$번 게이트의 입력일 경우 $i < j$임이 보장됩니다. 또한, 주어지는 모든 출력값을 동시에 충족시키는 입력값의 조합이 존재함이 보장됩니다.

### 출력

`0`, `1`, `?`로만 이루어진 길이 $m$의 문자열을 출력합니다. 이 문자열의 $i$번째 글자가 `0` 또는 `1`이면 $i$번 OR 게이트의 출력값이 확실히 0 또는 1임을, `?`는 그 게이트의 출력값을 알 수 없음을 의미합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저, 각각의 게이트의 출력은 어떤 입력의 집합의 OR임을 관찰합니다. 그리고 어떤 게이트의 출력이 0이면 그에 해당하는 모든 입력은 0으로 고정되며, 다른 게이트의 수식에서 모두 삭제할 수 있습니다.

또한, 어떤 게이트의 출력이 1일 때, 그 게이트의 입력 집합의 superset을 입력 집합으로 갖는 게이트의 출력은 1입니다. 반대로 확실히 1인 subset이 없다면 그 게이트의 출력은 알 수 없습니다.
이는 그 게이트의 모든 입력으로 0으로 만들고 나머지 입력을 모두 1로 만들어 모든 조건을 충족시킬 수 있기 때문입니다.

각각의 게이트에 해당하는 입력의 집합은 비트셋으로 나타낼 수 있습니다. 이제 출력이 0인 게이트에 해당하는 비트셋들을 모두 OR한 다음, 나머지 게이트들의 비트셋에서 모두 빼 줍니다.
이때 어떤 게이트의 비트셋에 켜진 비트가 0개가 되었다면 그 게이트의 출력은 0이 됩니다.

남은 게이트들 중에서 1인 것과 ?인 것을 분류하고, 1과 ?를 이중루프로 돌면서 ? 쪽이 superset이면 1을 적어주면 됩니다.

{{< /details >}}
