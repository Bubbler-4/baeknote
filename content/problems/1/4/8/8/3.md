---
params:
  boj: 14883
  bojTitle: NPM998244353 (Hard)
---

## 문제 내용

생략

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

{{< baeknote 14885 >}}의 $\mathcal{O}(P^2 MM^2)$ 풀이를 사용합니다.

$MM$이 커졌으므로 $MM^2$인 부분을 $MM \log MM$으로 최적화해야 할 것이라고 예상할 수 있습니다.

먼저 생성함수를 사용한 부분은 두 다항식의 곱 꼴이 명확하므로 바로 적용하면 됩니다. 그렇다면 DP테이블 부분은 어떻게 최적화할 수 있을까요?

어떤 $0 \le r, s < P$에 대해 $N_r$을 적용하는 루프에서 `dp[0][s]`가 식에 등장하는 dp테이블 엔트리를 찾아보면 다음과 같습니다.

```
dp[0][s], dp[1][(s+r)%P], dp[2][(s+2r)%P], ...
```

이들의 식을 잘 들여다보면 이전 dp테이블의 해당 칸들과 생성함수에서 얻은 값들의 convolution 꼴임을 알 수 있습니다. 따라서 이 부분 역시 $P$회의 다항식 곱으로 해결할 수 있습니다.

{{< /details >}}
