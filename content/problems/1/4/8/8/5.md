---
params:
  boj: 14885
  bojTitle: NPM998244353 (Easy)
---

## 문제 내용

생략

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저 떠오르는 방법은 한 자리씩 추가해 가면서 2차원 배열 `dp[자리수의 합][현재 수 % P]`을 전이시키는 것입니다. 그러나 $N$이 너무 크고, 이를 해결하기 위해 행렬 거듭제곱이나 선형점화식 계산 등을 써 보려고 해도
dp테이블의 크기가 25000이나 되므로 TLE를 피하기 어렵습니다.

다른 방법으로, $1 \bmod P, 10 \bmod P, 10^2 \bmod P, \cdots, 10^{N-1} \bmod P$들 각각을 총 $M$개 뽑아서 각각의 가능한 나머지를 만드는 방법의 수를 계산해볼 수 있습니다.
나머지가 같은 것끼리는 한꺼번에 계산할 수 있을 것 같으므로, 10의 거듭제곱 $\bmod P$들을 세어 개수만 저장해 줍니다. 나머지가 $r$인 10의 거듭제곱의 개수를 $N_r$이라고 합시다.

`dp[자리수의 합][현재 수 % P]`를 그대로 쓰는데, $N_r$을 안다면 각각의 $r$에 대해 다음의 전이 과정을 생각할 수 있습니다.

```
for x in range(MM+1):
    dp2[sum + x][(rem + x * r) % P] += dp[sum][rem] * (x를 0 이상 9 이하의 정수 N_r개로 분할하는 방법의 수)
```

이를 기존의 합과 나머지에 대해 반복하고, 다시 전체 과정을 모든 $r$에 대해 반복해야 하므로, `x를 0 이상 9 이하의 정수 N_r개로 분할하는 방법의 수`를 적당한 시간 내에 구할 수 있다면
전체 시간 복잡도 $\mathcal{O}(P^2 MM^2)$를 달성할 수 있을 것입니다.

이제 `n을 0 이상 9 이하의 정수 k개로 분할하는 방법의 수`를 구해야 합니다. 이를 $k$를 고정하고 $n$에 대한 수열로 보면, 이 수열에 대한 생성함수는 $(1 + x + x^2 + \cdots + x^9)^k$가 되며,
이는 다음과 같이 변환할 수 있습니다.

$$
\begin{align*}
& (1 + x + x^2 + \cdots + x^9)^k
= & \frac{(1 - x^{10})^k}{(1 - x)^k} \\
= & (1 - x^{10})^k \frac{1}{(1 - x)^k} \\
= & ({k \choose 0} - {k \choose 1} x^{10} + {k \choose 2} x^{20} - \cdots) ({k-1 \choose 0} + {k \choose 1} x + {k+1 \choose 2} x^2 + \cdots)
\end{align*}
$$

이제 여기서 필요한 값은 $0 \le n \le MM$일 때 $x^n$의 계수들이므로, 두 다항식을 각각 $MM$차에서 끊은 다음 다항식의 곱을 구함으로써 모든 $n$에 대한 답을 구할 수 있습니다.
이 과정의 시간 복잡도는 $\mathcal{O}(MM^2)$이고 $P$로 나눈 나머지 각각에 대해 한 번씩만 구해주면 되므로, 전체 시간 복잡도는 $\mathcal{O}(P^2 MM^2)$에서 변하지 않습니다.

{{< /details >}}
