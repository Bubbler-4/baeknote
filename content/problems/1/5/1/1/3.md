---
params:
  boj: 15113
  bojTitle: Grid Coloring
---

## 문제 내용

$r$행 $c$열의 정사각 격자의 일부가 파란색(`B`) 또는 빨간색(`R`)으로 칠해져 있습니다. 남은 빈 칸(`.`)을 칠하려고 하는데 다음의 조건을 충족해야 합니다.

* 모든 파란색 칸에 대해, 그 칸과 맨 왼쪽 위 칸을 두 꼭짓점으로 하는 직사각형 영역의 모든 칸 또한 파란색으로 칠해져 있어야 합니다.

그러한 색칠 방법의 수를 구하세요.

### 입력

첫 줄에 $r$과 $c$의 값이 주어집니다. ($1 \le r, c \le 30$)

다음 $r$줄에 걸쳐서 격자의 상태가 주어집니다.

### 출력

정답을 출력하세요. **이 값은 $2^{63}$보다 작음이 보장됩니다.**

## 문제 풀이

{{% details title="스포일러" closed="true" %}}

먼저 주어진 조건을 살펴보면, 빨간색 칸이 있으면 그 칸의 오른쪽과 아래는 모두 빨간색이어야 함을 알 수 있습니다.
결과적으로 파란색과 빨간색의 경계는 우상향의 계단 형태를 갖게 됩니다.

이를 이용하여, 먼저 주어진 격자에서 확정되는 파란색과 빨간색 칸을 모두 체크합니다. 둘이 겹친다면 답은 0입니다.

다음으로 DP를 구성합니다. `DP[i][j]`를 $i$번째 줄에서 맨 왼쪽부터 $j$개의 칸을 파란색으로 칠하는 경우의 수로 정의합니다.

그 줄에서 이미 칠해진 파란색 칸이나 빨간색 칸이 너무 많을 경우 이 값은 0으로 둡니다. 그렇지 않은 경우, 현재 줄에서 $j$칸을 파란색으로 칠하려면 직전 줄에서 $j$칸 이상을 파란색으로 칠해야 하므로, 이 값은 직전 줄의 `DP[i-1][j]`부터 `DP[i-1][c]`까지의 합이 됩니다.

맨 위에 모든 칸이 파란색인 가상의 줄이 있다고 생각하고 DP 초기 상태를 `[0, 0, ..., 0, 1]`로 두면 조금 더 간단하게 처리할 수 있습니다.

{{% /details %}}
