---
params:
  boj: 16011
  bojTitle: Min Max Tree
---

## 문제 내용

정점의 개수가 $N$인 트리가 주어집니다. 다음의 정보 $K$개가 모두 충족되도록 트리의 각 간선에 가중치를 적절히 할당하세요. 이러한 할당 방법은 반드시 존재함이 보장됩니다.

* `M x y z`: 정점 $x$에서 정점 $y$로 가는 경로상의 모든 간선의 가중치의 최댓값이 $z$입니다.
* `m x y z`: 정점 $x$에서 정점 $y$로 가는 경로상의 모든 간선의 가중치의 최솟값이 $z$입니다.

### 입력

첫 줄에는 $N$이 주어집니다. ($1 \le N \le 70\;000$)

다음 $N-1$줄에는 트리의 간선이 한 줄에 한 개씩 주어집니다. 각 간선은 양쪽 정점의 번호로 주어집니다.

다음 줄에는 $K$가 주어집니다. ($1 \le K \le 70\;000$)

다음 $K$줄에는 각각의 정보가 위의 형식으로 주어집니다. ($0 \le z \le 10^9$) 각 정보의 $z$의 값은 모두 서로 다릅니다.

### 출력

각 간선에 대해 가중치를 한 줄에 (정점 1, 정점 2, 가중치)의 순으로 출력합니다. 간선의 순서, 각 간선에서 두 정점의 순서는 상관 없습니다. 각 가중치는 32비트 부호 있는 정수로 표현 가능해야 합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저 각 간선이 가질 수 있는 최댓값과 최솟값을 구합니다. 이는 HLD와 레이지 세그먼트 트리를 이용하여 처리할 수 있습니다. HLD에서 간선 쿼리는 각 간선의 값을 parent-child 간의 연결에서 child 정점의 값인 것처럼 처리하면 됩니다.

이제 각각의 주어진 경로에 대해 정확히 $z$값을 갖는 간선이 하나 이상 있어야 합니다. 이분 매칭 알고리즘을 적용하여 각 간선에 최댓값과 최솟값 둘 중 하나를 매칭시키면 모든 조건을 충족시킬 수 있습니다. 조건에 의해 이러한 매칭은 반드시 존재합니다.

매칭되지 않고 남은 간선에 대해서는 범위 내의 가중치를 아무거나 넣어 주면 됩니다.

{{< /details >}}
