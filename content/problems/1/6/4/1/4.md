---
params:
  boj: 16414
  bojTitle: Mobilization
---

## 문제 내용

$n$개의 저울이 있습니다. $i$번째 저울 위에 $c_i$만큼의 모래를 올리면 A점수 $h_i$와 B점수 $p_i$를 얻습니다. 각 저울 위에는 임의의 음이 아닌 실수만큼의 모래를 올릴 수 있으며, 그때 얻는 A점수와 B점수는 그 모래의 양에 비례합니다.

모래가 $b$만큼 있을 때, A점수와 B점수의 곱을 최대화하세요.

### 입력

첫 줄에는 $n$과 $b$가 주어집니다. ($1 \le n \le 30\;000$, $1 \le b \le 100\;000$)

다음 $n$줄에는 각 저울의 $c_i$, $h_i$, $p_i$의 값이 주어집니다. ($1 \le c_i \le 100\;000$, $0 \le h_i, p_i \le 1$, $c_i$는 정수, $h_i$, $p_i$는 소수점 20자리 이하의 실수)

### 출력

문제의 정답을 출력합니다. 절대 또는 상대 오차가 0.005 미만이면 정답으로 인정됩니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저 각각의 $h_i$와 $p_i$를 $c_i$로 나누어 단위 모래 당 점수로 바꿉니다. 그리고 A점수와 B점수를 각각 $b$로 나누면 각각 A점수의 가중평균과 B점수의 가중평균이 됩니다.

이때 각각의 가중평균은 반드시 $(h_i, p_i)$로 이루어진 점들의 볼록 껍질 이내에 있으며, 그 중에서 다른 좌표에 dominate되지 않는 점들의 집합은 볼록 껍질의 오른쪽 위 부분의 테두리입니다.

그리고 그 테두리 위의 모든 점은 그 점을 포함하는 선분의 양 끝점만을 사용하여 만들 수 있으며, 그 결과로 얻는 A점수와 B점수의 곱은 하나의 변수에 대한 이차식이 됩니다.

이제 각 선분에 대해 이러한 이차식의 최댓값들을 구하여 모든 값들 중에서 최댓값을 취하면 그것이 답이 됩니다.

{{< /details >}}
