---
params:
  boj: 17159
  bojTitle: Miniature Golf
---

## 문제 내용

$p$명의 사람들이 $h$개의 홀로 이루어진 골프 코스에서 골프를 쳤습니다. 어떤 사람이 어떤 홀에서 얻는 점수는 그 홀에서 공을 친 횟수와 같고, 그 횟수가 특정 값 $\ell$을 초과하면 $\ell$로 처리합니다.
어떤 사람의 총점은 각 홀에서 얻은 점수의 총합이며, 총점이 낮은 사람이 순위가 높습니다 (순위의 값이 작습니다). 여러 사람이 같은 총점을 가질 수도 있기 때문에, 한 사람의 순위의 값은
`그 사람의 총점 이하의 총점을 갖는 모든 사람의 수`로 정의합니다.

그런데 $\ell$의 값을 아는 사람이 없습니다. 가능한 모든 $\ell$의 값에 대해 각 사람이 가질 수 있는 최고 순위 (가장 작은 값의 순위)를 구하세요.

### 입력

첫 줄에는 $p$와 $h$가 주어집니다. ($1 \le p \le 500$, $1 \le h \le 50$)

다음 $p$줄에는 각 사람이 $h$개의 홀에서 얻은 점수가 순서대로 주어집니다. 각 점수는 $10^9$를 초과하지 않는 양의 정수입니다.

### 출력

각 사람이 가질 수 있는 최고 순위를 한 줄에 하나씩 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

각 사람의 쌍은 대소관계가 최대 $h$번 바뀔 수 있습니다 (`==`를 포함하면 최대 $2h$). 따라서, 최대 $p^2 h$번의 쌍 간 순위 변동에 대해 그에 해당하는 $\ell$의 값이 증가 (또는 감소)하는 순으로 확인하면서
순위 변동을 처리할 수 있습니다. 순위는 자신 이하의 점수를 갖는 사람의 수이므로 이전 대소관계와 새로운 대소관계를 알면 두 사람의 새로운 순위를 구할 수 있고, 여러 쌍 간의 순위가 같은 $\ell$에 대해 동시에 바뀐다면,
이를 모두 동시에 처리한 뒤의 순위를 확인하면 됩니다.

$p^2 h$의 값이 다소 크기 때문에 모든 교점을 미리 찾아 정렬하기는 어렵고, $p^2$개의 투 포인터를 유지하고 각 쌍에 대해 다음에 적용될 $\ell$의 값에 대한 min(또는 max) heap으로 다음 변경사항을 관리할 수 있습니다.

{{< /details >}}
