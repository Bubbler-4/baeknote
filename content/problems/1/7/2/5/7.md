---
params:
  boj: 17257
  bojTitle: 불확정성이 넘쳐흘러
---

## 문제 내용

생략

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

길이 $x$의 구간에 대한 $f_Y(i, j)$의 값은 모두 같음이 자명하므로, 각각의 길이에 대한 답을 구한 뒤 그러한 구간의 개수 $n-x+1$을 곱해서 합해주면 됩니다.

$x$개의 수를 뽑은 결과의 GCD가 $Y$와 서로소이려면, $Y$의 서로 다른 소인수들이 $p_1, p_2, \cdots, p_k$라고 할 때 모든 $p_i$에 대해 $x$개의 수가 모두 $p_i$의 배수이지만 않으면 됩니다.

$i < j$일 때 각각의 뽑힌 수가 $p_i$의 배수가 아닌 사건과 $p_j$의 배수가 아닌 사건은 서로 독립이고, $x$개의 수 중 $p_i$의 배수가 아닌 것이 있을 확률은 $1 - \frac{1}{p_i^x}$이므로, 관측 결과가 $Y$와 서로소일 확률은 다음과 같습니다.

$$
(1 - \frac{1}{p_1^x})(1 - \frac{1}{p_2^x}) \cdots (1 - \frac{1}{p_k^x})
$$

이제 여기에 $Y^N$을 곱한 값을 구하여 모두 합쳐주면 문제의 $Z$의 값을 구할 수 있습니다.

{{< /details >}}
