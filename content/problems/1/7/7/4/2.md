---
params:
  boj: 17742
  bojTitle: Bus Tour
---

## 문제 내용

어떤 도시에 $W$개의 세로 도로와 $H$개의 가로 도로가 서로 교차하고 있습니다. 두 이웃한 가로 도로와 두 이웃한 세로 도로는 각각 1km씩 떨어져 있습니다.
왼쪽에서 $x$번째 세로 도로와 위에서 $y$번째 가로 도로가 교차하는 지점을 $(x, y)$라고 합시다.

이 도시에는 총 $N$대의 버스가 운행하고 있습니다. 각 버스의 노선은 4개의 정수 $X_1, Y_1, X_2, Y_2$로 나타낼 수 있는데,
이는 $X_1$번과 $X_2$번 세로 도로, 그리고 $Y_1$번과 $Y_2$번 가로 도로가 이루는 직사각형 위를 시계 방향으로 운행한다는 뜻입니다. ($1 \le X_1 < X_2 \le W$, $1 \le Y_1 \le Y_2 \le H$)

각 버스는 1분에 1km씩 이동합니다. 당신은 이 도시의 버스만을 이용하여 $(S_x, S_y)$에서 $(G_x, G_y)$로 이동하려고 합니다. 당신이 버스를 타지 않고 있는 동안은 그 자리에 가만히 있다고 가정합니다.
한 버스에서 내린 뒤에는 적어도 1분 뒤에 다른 버스를 탈 수 있습니다. 버스에서 타고 내리는 행동 자체는 시간이 걸리지 않습니다.

$(S_x, S_y)$에서 $(G_x, G_y)$로 이동하는데 최소 몇 분이 걸릴지 구하세요.

### 입력

첫 줄에 $W, H, S_x, S_y, G_x, G_y$가 순서대로 주어집니다. ($2 \le W, H \le 1000$)

두 번째 줄에 버스의 수 $N$이 주어집니다. ($1 \le N \le 1000$)

세 번째 줄부터 각 버스의 정보가 한 줄에 하나씩 주어집니다. 한 줄에는 다섯 개의 정수가 주어지며, 처음 네 개는 $X_1, Y_1, X_2, Y_2$를 나타내고, 다섯 번째 수 $T$는 당신이 이동을 시작한 시각에
버스가 노선의 북서쪽 꼭짓점으로부터 몇 km 이동한 상태인지를 나타냅니다. ($0 \le T < 2(X_2 - X_1 + Y_2 - Y_1)$)

### 출력

문제의 정답을 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

최단 거리 문제로 모델링해 봅시다.

먼저, 버스에서 내린 상태가 $WH$개, 버스를 타고 있는 상태가 (노선의 길이의 총합)개만큼 있을 수 있습니다. 노선의 최대 길이는 대략 $2(W+H)$이므로, 전체 상태는 약 5백만 개 정도가 됩니다.

그리고 상태 변화를 적절히 추려 보면 다음과 같이 정리할 수 있습니다.

* 버스에 타지 않은 상태: 다음에 오는 버스를 탑니다. 이는 현재 위치를 통과하는 모든 버스에 대해 한 번만 처리하면 되며, 최대 $2(W+H)$ 정도의 시간을 기다려야 합니다.
* 버스에 탄 상태: 지금 바로 버스에서 내리거나(시간 0), 버스를 탄 채로 1만큼 이동합니다(시간 1).

첫 번째 경우는 노선의 길이의 합 만큼이 있고, 두 번째는 노선의 길이의 합의 두 배만큼이 있으므로, 전체 상태 변화는 약 1200만 개 정도가 됩니다.

시간이 3초이지만 전반적으로 구현이 많고 단위 연산의 양도 많은 만큼 Dijkstra로 통과하기는 어렵고, 대신 가중치가 최대 4000이므로 Dial을 사용하여 풀 수 있습니다.

{{< /details >}}
