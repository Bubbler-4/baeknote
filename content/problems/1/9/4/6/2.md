---
params:
  boj: 19462
  bojTitle: Immigration
---

## 문제 내용

점 $P$가 원점에서 시작하여 $x$축 위에서 초당 $u$의 속도로 양의 $x$ 방향으로 이동하고 있습니다.

점 $P$가 이동하기 시작한지 $t_0$초 후에 점 $Q$가 $(x_0, y_0)$ 위치에 등장하여 $(v_{0x}, v_{0y})$의 속도로 움직이기 시작합니다.
이 점 $Q$는 점 $P$가 이동하기 시작한지 $t_1, t_2, \cdots, t_n$초 후에 각각 $(v_{ix}, v_{iy})$로 속도를 바꿉니다.

점 $P$에는 카메라가 달려 있어서 $P$에서 $Q$가 보이는 방향을 항상 바라보고 있습니다. 이때 이 카메라의 각속도의 절댓값의 최댓값을 구하세요.

### 입력

첫 줄에는 네 개의 정수 $u$, $x_0$, $y_0$, $n$이 주어집니다. ($1 \le u \le 100$, $|x_0|, |y_0| \le 10^8$, $0 \le n \le 10^5$)

다음 $n+1$개의 줄에는 각각 세 개의 정수 $t_i$, $v_{ix}$, $v_{iy}$가 주어집니다. ($0 \le t_i \le 10^6$, $|v_{ix}|, |v_{iy}| \le 100$, $t_0 < t_1 < \cdots < t_n$)

$(v_{ix}, v_{iy}) = (0, 0)$일 수 있습니다. $t_n$ 시간 이후에 $Q$는 $(v_{nx}, v_{ny})$의 속도로 무한히 움직입니다. $Q$는 $P$와 충돌하지 않음이 보장됩니다.

### 출력

문제의 정답을 출력합니다. 출력값의 정답과의 절대 또는 상대 오차가 $10^{-6}$ 이하이면 정답으로 인정됩니다. 정답은 유한한 값임이 보장됩니다.

## 문제 풀이

{{% details title="스포일러" closed="true" %}}

일단 $P$를 원점에 고정하고 $Q$의 상대이동을 생각합니다. 이제 문제는 $Q$의 이동을 나타내는 각 선분 또는 반직선 위에서 최대의 절대 각속도를 찾는 문제가 됩니다.

어떤 선분이 주어졌을 때, 이 선분을 회전하여 기울기가 0인 직선 상에서 양의 방향으로 운동하도록 하고 $x=0$인 시점을 시간 $t=0$으로 두어도 문제가 없습니다. 각속도는 $\frac{d\theta}{dt}$이므로, 이 상황에서 극좌표계로 식을 세우고 미분을 해 봅시다.

$$
x = r \cos \theta = vt, y = r \sin \theta = y_0 \\
dr \cos \theta - r \sin \theta d\theta = vdt \\
dr \sin \theta + r \cos \theta d\theta = 0
$$

이제 $dr$ 항을 지우면 다음의 식을 얻습니다.

$$
r d\theta = -v \sin \theta dt \\
\frac{d\theta}{dt} = -\frac{v}{r} \sin \theta
$$

여기서 $\theta$의 값은 $(0, \pi)$ 내에서 움직이며, 자명하게 $\theta = \frac{\pi}{2}$ ($t = 0$)에서 최대 절댓값을 갖고 멀어질수록 감소합니다.

원점에서 직선으로 수선을 내리면 직각삼각형을 얻을 수 있고, 수선의 길이는 $y_0$이므로 $\sin \theta$를 거리의 비율로 환산하여 다음의 식을 얻을 수 있습니다.

$$
\frac{d\theta}{dt} = -\frac{v y_0}{r^2}
$$

이제 각 선분에 대해 그 직선 상의 점과의 최소 거리와 그 거리를 갖는 시간을 계산하여, 최소 거리 지점이 선분 위에 있으면 그 점에 대한 값을, 아니라면 두 끝점 중 최댓값을 계산하여 그러한 모든 값들 중 최댓값을 출력하면 됩니다.

{{% /details %}}
