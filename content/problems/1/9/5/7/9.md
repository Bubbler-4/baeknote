---
params:
  boj: 19579
  bojTitle: 물건 가져가기
---

## 문제 내용

1번부터 $N$번까지 번호가 매겨져 있는 $N$개의 물건이 있습니다. 각 물건은 획득했을 때 얻거나 잃는 점수가 있으며, 어떤 물건은 다른 몇 개의 물건을 획득해야 동시에 획득할 수 있습니다.
단, 획득하는 순서는 상관 없습니다. 예를 들어, A를 획득하려면 B를 획득해야 하고 B를 획득하려면 A를 획득해야 한다면, A와 B를 동시에 획득하는 것이 가능합니다.

이때 획득한 물건들의 점수의 총합을 최대화하는 방법을 아무거나 찾아 출력하세요.

### 입력

첫 줄에는 물건의 개수 $N$과 물건 간의 관계의 수 $M$이 주어집니다. ($1 \le N \le 200$, $1 \le M \le 400$)

다음 $N$줄에는 각 물건의 점수 $t_i$가 주어집니다. 이 값들은 정수입니다. ($-100\;000 \le t_i \le 100\;000$)

그다음 $M$줄에는 관계를 갖는 두 물건의 번호 $s_i, e_i$가 주어집니다. $s_i$를 획득하기 위해서는 $e_i$도 획득해야 한다는 의미입니다.

### 출력

첫 줄에는 획득할 물건의 개수를 출력합니다.

다음 줄에는 획득할 물건들의 번호를 아무 순서로 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

이 문제는 binary string min-cut modeling으로 풀 수 있습니다.

* $t_i > 0$일 경우 $i$번 물건을 제외하는 페널티는 $t_i$입니다.
* $t_i < 0$일 경우 $i$번 물건을 포함하는 페널티는 $-t_i$입니다.
* $i$번 물건을 획득하기 위해 $j$번 물건을 획득해야 한다면, $i$를 포함하고 $j$를 제외하는 페널티는 $\infty$입니다.

여기서 maximum flow를 돌린 뒤에 포함된 물건의 목록을 추출하려면, Dinic을 사용한 경우 마지막 BFS의 결과를 보면 source에서 접근 가능한 노드의 집합이 선택한 물건의 집합이 됩니다.

{{< /details >}}
