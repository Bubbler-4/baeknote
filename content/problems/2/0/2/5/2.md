---
params:
  boj: 20252
  bojTitle: Garden
---

## 문제 내용

$n$행 $m$열의 사각 격자가 주어집니다. 각 칸은 `.`이거나 `*`입니다. 두 개의 `C`가 상하좌우로 이웃하지 않도록 `.`인 칸 중 일부를 `C`로 바꾸는 방법 중에서 `C`가 가장 많게 하는 방법을 아무거나 하나 찾아 출력하세요.

### 입력

첫 줄에는 $n$과 $m$의 값이 주어집니다. ($1 \le n \times m \le 10^5$)

다음 $n$줄에는 격자의 상태가 주어집니다.

### 출력

첫 줄에는 `C`의 개수를 출력합니다.

다음 $n$줄에는 그만큼의 `C`를 배치한 방법을 출력합니다.

## 문제 풀이

{{% details title="스포일러" closed="true" %}}

사각 격자는 이분 그래프임은 잘 알려져 있습니다. 이분 그래프의 최대 독립 집합의 크기는 노드의 총 개수에서 최대 이분 매칭의 크기를 뺀 것과 같습니다.

최대 독립 집합의 실례를 구하기 위해서는 다음과 같이 구할 수 있습니다.

* 먼저 이분 매칭 알고리즘을 수행하여 매칭된 노드의 쌍들과 매칭되지 않은 노드들의 목록을 구합니다.
* 각각의 **매칭되지 않은 노드** $u$에 대해 다음을 수행합니다.
  * $u$를 선택하고, $u$의 모든 이웃 $v$를 제외합니다.
  * 각각의 이웃 $v$는 모두 매칭된 이웃 노드 $u'$가 존재합니다. (그렇지 않다면 augmenting path가 찾아진 것이므로 모순입니다.) 그러한 $u'$를 재귀적으로 방문합니다.
* 아직 처리되지 않은 노드들이 존재한다면, 이들은 모두 매칭된 노드의 쌍의 일부입니다. 각각의 쌍에서 같은 쪽 집합에 속하는 노드들을 모두 선택하고 나머지를 모두 제외합니다.

{{% /details %}}
