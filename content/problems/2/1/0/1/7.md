---
params:
  boj: 21017
  bojTitle: Forming Compounds
---

## 문제 내용

$N$종류의 원자가 있습니다. $i$번 원자의 원자량은 양의 정수 $W_i$입니다. 셰릴은 이들 중에서 $i$번 원자와 $j$번 원자를 조합하여 분자를 만들려고 합니다.
원자 $A$와 $B$로 이루어진 분자는 원자 $A$와 원자 $B$를 각각 1개 이상씩 포함하며, 이 분자의 분자량은 각 원자의 원자량의 총합입니다.
$i$번 원자와 $j$번 원자($i < j$)로 이루어진 분자의 **타입**을 $(i, j)$라고 합시다.

어떤 분자 타입의 **다양도**는 그 분자 타입에서 얻을 수 있는 분자량 중에서 $10^{12}$ 이하인 것의 개수입니다. 예를 들면,

* $W_i = 2, W_j = 3$이면 $(i, j)$의 다양도는 $999\;999\;999\;995$입니다.
* $W_i = 2, W_j = 4$이면 $(i, j)$의 다양도는 $499\;999\;999\;998$입니다.
* $W_i = 3, W_j = 4$이면 $(i, j)$의 다양도는 $999\;999\;999\;991$입니다.
* $W_i = 3, W_j = 3$이면 $(i, j)$의 다양도는 $333\;333\;333\;332$입니다.

서로 다른 분자의 타입은 총 $\frac{N(N-1)}{2}$개 존재합니다. 다양도가 $x$인 분자를 하나 만들면 다양도가 $x$인 모든 분자 타입의 분자들이 동시에 생성됩니다.
원하는 타입의 분자를 생성할 수 있다고 할 때, 다음의 질문을 $Q$번 해결하세요.

* 셰릴은 정확히 $K$개의 분자 타입을 얻을 수 있을까요?

### 입력

첫 줄에는 $N$과 $Q$가 주어집니다. ($2 \le N \le 500$, $1 \le Q \le 100\;000$)

다음 줄에는 각 원자의 원자량 $W_1, W_2, \cdots, W_N$이 주어집니다. ($1 \le W_i \le 100\;000$)

다음 $Q$줄에는 각각의 질문에 대한 $K$의 값이 주어집니다.

### 출력

각 질문에 대해, $K$개의 분자 타입을 얻을 수 있으면 `YES`, 아니면 `NO`를 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저 각각의 분자 타입의 다양도를 구합니다. $W_i W_j < 10^{12}$이므로, $\gcd(W_i, W_j) = 1$일 경우에 만들 수 **없는** 분자량의 개수를 구하면 됩니다. 서로소가 아니라면 두 원자량과 상한을 모두 GCD로 나누어 줍니다.

서로소인 두 양의 정수 $a$와 $b$에 대해, $ax + by$ ($x, y > 0$) 꼴로 나타낼 수 없는 양의 정수는 다음과 같습니다.

* $b$ 이하이면서 $a$로 나눈 나머지가 $b \bmod a$와 같은 것의 개수
* $2b$ 이하이면서 $a$로 나눈 나머지가 $2b \bmod a$와 같은 것의 개수
* ...
* $ab$ 이하이면서 $a$로 나눈 나머지가 $ab \bmod a$와 같은 것의 개수

여기서 $a$가 홀수이면, 나머지가 $kb \bmod a$인 것과 $(a-k)b \bmod a$인 것을 묶을 수 있습니다. 그러면 다음과 같이 됩니다.

$$
\begin{align*}
&|\{x | 0 < x \le kb, x \equiv kb (\bmod a)\}| + |\{x | 0 < x \le (a-k)b, x \equiv (a-k)b (\bmod a)\}| \\
= &|\{x | 0 < x \le kb, x \equiv kb (\bmod a)\}| + |\{x | kb \le x < ab, x \equiv kb (\bmod a)\}| \\
= &|\{x | 0 < x < ab, x \equiv kb (\bmod a)\}| + 1 \\
= &b + 1
\end{align*}
$$

따라서 이러한 양의 정수의 총 개수는 $\frac{a-1}{2}(b+1) + b$입니다. $a$가 짝수이면 $b$가 홀수여야 하므로 뒤집어서 계산하면 됩니다.

이제 모든 분자 타입의 다양도를 구해서 개수를 세고, 이를 가지고 냅색을 하면 됩니다. 서로 같은 수들을 2의 거듭제곱으로 잘 묶으면 서로 다른 수의 개수를 최대 $N$개로 줄여서 $\mathcal{O}(N^3)$에
냅색을 할 수 있게 되지만, 단순히 개수 순으로 정렬한 뒤 비트셋 냅색을 가능한 적은 연산량으로 수행하는 것만으로도 통과할 수 있습니다.

{{< /details >}}
