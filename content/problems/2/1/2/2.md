---
params:
  boj: 2122
  bojTitle: 여섯이서 놀기
---

## 문제 내용

$n$ ($6 \le n \le 150$)개의 정점을 갖는 무방향 그래프의 인접 행렬이 주어집니다. 여기서 서로 다른 정점 6개로 이루어진 사이클의 개수를 $9901$로 나눈 나머지를 구하세요.
한 사이클을 시작 위치만 바꿔서 같은 순서로 방문하거나, 반대 순서로 방문한 것은 같은 사이클입니다.

## 문제 풀이

{{% details title="스포일러" closed="true" %}}

먼저 한 사이클의 1, 3, 5번째 정점을 고정합니다. 그러면 2, 4, 6번째로 올 수 있는 정점들의 목록을 각각 구할 수 있습니다. 1, 3, 5번째 정점으로 사용한 것들은 사용할 수 없으므로 목록에서 제거해 줍니다.

그리고 나서, 2, 4, 6번째 정점들의 목록에서 세 개의 정점을 고르는 방법의 수를 구합니다. 여기서는 포함배제를 쓸 수도 있고, 각각의 목록을 $A, B, C$라고 할 때 $A$에만 포함되는 것, $B$에만 포함되는 것, ... $A, B, C$ 모두에 포함되는 것의 개수를 구한 다음
각각의 집합들의 조합에서 정점들을 적절히 고르는 방법의 수를 모두 더해도 됩니다.

이를 모든 1, 3, 5번째 정점의 조합(번호 오름차순)에 대해 반복하여 모두 더하면, 같은 사이클은 정확히 두 번씩 더해진 상태가 됩니다. 6개의 정점을 모두 정했을 때 세어지는 방법은 1, 3, 5번째 정점이 번호 오름차순이 되도록 돌리고 뒤집은 것과,
2, 4, 6번째 정점이 1, 3, 5번째에 오도록 한 칸 돌린 다음에 동일하게 돌리고 뒤집은 것뿐이기 때문입니다. 따라서 그 결과를 2로 나눈 값을 출력하면 됩니다.

이렇게 하면 $\mathcal{O} (n^4)$ 알고리즘을 얻습니다. 집합의 교집합과 여집합, 그리고 원소의 개수를 세는 것은 모두 비트셋으로 하면 빠르게 수행할 수 있습니다.

{{% /details %}}
