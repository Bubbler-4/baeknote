---
params:
  boj: 22598
  bojTitle: Approximate Circle
---

## 문제 내용

좌표평면에 $n$개의 점이 주어집니다. 점의 분포를 $x^2 + y^2 + ax + by + c = 0$의 원으로 근사하려고 합니다. 아래의 least squares error를 최소화하는 원의 식을 구하세요.

$$\sum_{i=1}^{n} (x_i^2 + y_i^2 + ax_i + by_i + c)^2$$

### 입력

첫 줄에는 점의 개수 $n$이 주어집니다. ($3 \le n \le 40\;000$) 다음 $n$줄에는 각각 점의 좌표 $x_i, y_i$가 주어집니다. 좌표의 값들은 모두 정수입니다. ($0 \le x_i, y_i \le 1\;000$)

모든 점이 하나의 직선 위에 있는 입력은 주어지지 않습니다.

### 출력

$a, b, c$의 값을 소수점 이하 셋째 자리까지 출력합니다. 이 값이 정답과 $0.001$ 이하의 차이가 나면 정답으로 인정됩니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

주어진 식은 $a, b, c$에 대해 각각 1차식이고, least squares error를 최소화하는 $a, b, c$를 구하는 방법은 [Wikipedia 문서](https://en.wikipedia.org/wiki/Ordinary_least_squares#Matrix/vector_formulation)에 잘 소개되어 있습니다.

각각의 점에 대한 식을 $ax_i + by_i + c = -x_i^2 - y_i^2$로 정리하면 $X_i \beta = y_i$ 꼴이 되고, $X_i$들을 모아서 $n$행 3열의 행렬 $X$, $y_i$들을 모아서 길이 $n$의 벡터 $y$를 만들면
답은 $(X^\top X)^{-1} X^\top y$가 되고, $3 \times 3$ 행렬의 역행렬을 구하여 답을 구할 수 있습니다.

Gradient descent로도 되나 시도해봤지만, 수렴시키기 꽤 까다로운 것 같습니다. 수렴시키기 어려운 형태의 입력으로는 다음이 있습니다.

```
3
0 0
1 0
100 1
```

이 경우의 정답은 $(-1, -9901, 0)$입니다.

{{< /details >}}
