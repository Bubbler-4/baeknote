---
params:
  boj: 22770
  bojTitle: Ellipse Intersection
---

## 문제 내용

원점을 중심으로 하는 두 타원이 겹치는 부분의 넓이를 구하세요. 첫 번째 타원은 가로로 길고, 두 번째 타원은 세로로 긺이 보장됩니다.

### 입력

첫 줄에는 테스트 케이스의 개수 $n$이 주어집니다. ($1 \le n \le 100$)

각 테스트 케이스에 대해, 타원의 방정식을 $\frac{x^2}{a^2} + \frac{x^2}{b^2} = 1$이라고 할 때, 첫 번째 줄에는 첫 번째 타원의 $a$와 $b$의 값이 주어지고, 두 번째 줄에는 두 번째 타원의 $a$와 $b$의 값이 주어집니다.

### 출력

각 테스트 케이스에 대해, 문제의 답을 출력합니다. 정답과의 절대 오차가 0.001 이하이면 정답으로 인정됩니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저, 한쪽 타원이 반대쪽 타원에 완전히 포함되는 경우를 걸러냅니다. 타원의 면적의 공식은 $\pi a b$이므로, 작은 쪽의 면적을 이 공식으로 계산하여 출력하면 됩니다.

이제 두 번째 타원의 방정식을 $\frac{x^2}{c^2} + \frac{y^2}{d^2} = 1$로 두고, 두 타원의 1사분면에서의 교점을 $(x_1, y_1)$이라고 합시다. 이 교점은 연립방정식을 풀어 구할 수 있으며, 다음과 같습니다.

$$
(x_1, y_1) = (\sqrt{\frac{a^2 c^2 (d^2 - b^2)}{a^2 d^2 - b^2 c^2}}}, \sqrt{\frac{b^2 d^2 (a^2 - c^2)}{a^2 d^2 - b^2 c^2}}})
$$

이제 원하는 면적은 1사분면에서의 면적을 4배 하면 되고, 1사분면에서의 면적은 첫 번째 타원을 0에서 $x_1$까지 적분한 것과 두 번째 타원의 가로 세로를 뒤집은 다음 0에서 $y_1$까지 적분한 것을 더하고, 그 두 영역이 겹치는 직사각형의 면적 $x_1 y_1$을 빼면 됩니다.

$y = b \sqrt{1 - \frac{x^2}{a^2}}$를 0에서 $x_1$까지 적분한 것은 $t = \frac{x}{a}$, $w = \sin t$의 순서로 치환적분을 하면 $w_1 = \arcsin \frac{x}{a}$일 때 $ab(\frac{w_1}{2} + \frac{\sin 2w}{4})$가 됩니다.

{{< /details >}}
