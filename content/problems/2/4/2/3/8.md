---
params:
  boj: 24238
  bojTitle: Bombs
---

## 문제 내용

당신은 건물 폭파 미션을 받았습니다. 이 건물을 폭파하려면 각각의 폭탄을 특정한 방에 가져다 놓아야 합니다. 이 건물의 어떤 방과 방 사이, 그리고 방과 외부 사이에는 문이 있으며, 방에서 방으로, 또는 외부에서 방으로
이동하기 위해서는 이러한 문을 이용해야 합니다.

그런데 이 건물과 폭탄에는 특이한 점이 있어서, 각각의 문에 대해서 하루에 최대 하나의 폭탄만 통과할 수 있고, 각각의 폭탄도 하루에 최대 하나의 문만을 통과할 수 있습니다.

당신은 이 건물 내부와 외부를 자유롭게 이동할 수 있다고 할 때, 모든 폭탄을 정해진 위치에 가져다 놓는데 최소 며칠이 걸리는지 구하세요.

### 입력

첫 줄에는 건물의 방의 개수 $n$, 문의 개수 $m$, 폭탄의 개수 $k$가 주어집니다. ($1 \le n \le 100$, $1 \le m \le 400$, $1 \le k \le 8$)
건물의 내부의 방은 1부터 $n$까지의 번호가 매겨져 있고, 건물의 외부는 편의상 0번 방이라고 합니다.

두 번째 줄에는 $k$개의 정수가 주어집니다. 이는 각각의 폭탄이 설치되어야 할 방의 번호를 나타냅니다. 이 값들은 모두 1 이상입니다.

세 번째 줄부터 각 줄에는 각각의 문이 연결하는 두 방의 번호가 주어집니다. 두 방의 번호는 서로 다릅니다. 여러 개의 문이 같은 쌍의 방을 연결할 수 있습니다.

### 출력

문제의 정답을 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

이 문제는 플로우로 모델링하고 $d$일이 주어졌을 때 가능한지를 판별하여 이분 탐색으로 풀 수 있습니다.

$d$를 고정하면 다음과 같이 모델링할 수 있습니다.

* 0번부터 $n$번까지의 정점들을 $d+1$번 복붙하고, 각각 0번 그룹, 1번 그룹, $\cdots$, $d$번 그룹이라고 합시다.
* $u$와 $v$ 사이에 간선이 있으면, $i$번 그룹의 $u$에서 $i+1$번 그룹의 $v$로 가는 용량 1의 간선, 그리고 $v$에서 $u$로 가는 간선을 추가합니다.
* 각 정점에서는 폭탄이 원하는 개수만큼 가만히 있을 수 있으므로 $i$번 그룹의 $u$에서 $i+1$번 그룹의 $u$로 용량 $\infty$의 간선을 추가합니다.
* source를 0번 그룹의 0번 정점으로 두고, sink는 따로 만든 다음, 각각의 폭탄의 목적지 $u$에 대해 $d$번 그룹에 $u$에서 sink로 용량 1의 간선을 추가합니다.

이렇게 한 뒤 $k$만큼의 플로우가 흐를 수 있으면 모든 폭탄이 각각의 목적지에 도달할 수 있음을 나타내며, 그렇지 않다면 불가능함을 나타냅니다.

{{< /details >}}
