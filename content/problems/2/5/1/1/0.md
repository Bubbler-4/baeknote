---
params:
  boj: 25110
  bojTitle: Regional development
---

## 문제 내용

어떤 도로 네트워크에 대해 다음의 조건을 충족시키려고 합니다.

1. 각 도로에서 1명 이상 $M$명 미만의 정해진 수의 행상인이 한 방향으로 이동합니다.
2. 각 교차로에서 들어오는 행상인의 수와 나가는 행상인의 수가 같습니다.

한 수학자가 위의 조건을 충족하는 방법은 찾아내지 못했지만, 대신 1번 조건과 다음의 조건을 충족하는 방법을 찾았습니다.

* 각 교차로에서 들어오는 행상인의 수와 나가는 행상인의 수의 차이는 $M$의 배수입니다.

이때 원래의 조건을 충족하는 방법이 존재하면 그러한 방법을 아무거나 하나 찾아 출력하세요.

### 입력

첫 줄에는 교차로의 수 $N$, 도로의 수 $R$, 그리고 $M$의 값이 주어집니다. ($1 \le N \le 1000$, $0 \le R \le 10\;000$, $2 \le M \le 1000$)

다음 $R$줄에는 각 도로의 양 끝점 $A_i, B_i$와 그 도로 위로 이동할 행상인의 수 $C_i$가 주어집니다. 이는 $C_i$명의 행상인이 $A_i$에서 출발해서 $B_i$로 이동한다는 뜻입니다. 이 입력은 수학자의 조건을 충족합니다.

### 출력

원래의 조건을 충족하는 방법이 존재한다면, $1 \le i \le R$에 대해 $i$번 도로 위로 이동해야 할 행상인의 수를 한 줄에 하나씩 출력합니다.
행상인이 입력과 반대 방향으로 이동해야 한다면 그 수에 $-1$을 곱해서 출력합니다.

그러한 방법이 존재하지 않는다면 `IMPOSSIBLE`을 대신 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

이 문제는 circulation 없이 풀 수 있습니다.

먼저, 각 도로의 흐름에서 $M$만큼을 빼면 (즉 반대 방향으로 $M - C_i$만큼 흐름) 1번 조건을 충족합니다. 따라서 도로들 중 몇 개에서 $M$을 빼서 2번 조건을 충족시킬 수 있는지를 보면 됩니다.

그리고, 하나의 경로 상의 도로들에서 $M$을 빼면 그 경로의 시작점의 나가는 행상인의 수가 $M$ 감소하고 끝점에 들어오는 행상인의 수가 $M$ 감소합니다. 이 과정을 반복하는 것은 일반적인 s,t-플로우와 동치입니다.
따라서 나가는 행상인의 수가 많은 교차로와 들어오는 행상인의 수가 많은 교차로를 각각 sink와 source에 연결하고 (용량은 필요한 차이를 $M$으로 나눈 값), 원래 도로들은 역방향으로 용량 1의 간선으로 만들어 준 뒤
플로우를 흘려서 플로우가 흐른 간선들에 대해 $M$을 빼 주면 됩니다. 최대 유량이 필요한 값만큼 나오지 않으면 불가능입니다.

{{< /details >}}
