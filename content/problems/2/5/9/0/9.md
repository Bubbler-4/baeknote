---
params:
  boj: 25909
  bojTitle: 수확의 계절이다!
---

## 문제 내용

사각 격자로 나누어진 무한한 평면에서 작물을 심고 수확하려고 합니다. 이 평면 상에서 이동할 경로가 주어집니다. 이 경로 상에서 당신은 한 번 이동할 때마다 다음의 동작을 수행할 수 있습니다.

* 이 칸에 작물이 있다면, 이 칸의 작물을 수확합니다. 수확하면 이 칸은 작물이 없는 상태가 되며, 그 작물을 심은 지 $x$ 시간이 지난 상태라면 작물 1개를 얻습니다.
* 이 칸에 작물이 없다면, 이 칸에 작물을 심습니다.

한 번 이동한 직후에 작물을 수확하는 동작과 작물을 심는 동작을 모두 해도 됩니다. 한 번 이동하는 데는 1의 시간이 걸리고, 작물을 수확하거나 심는 데는 시간이 걸리지 않습니다.

이때 작물 $K$개를 얻을 수 있는 최대의 $x$를 구하세요. ($x$는 양의 정수)

### 입력

첫 줄에는 입력의 길이 $N$과 얻어야 할 작물의 수 $K$가 주어집니다. ($1 \le N \le 1000$, $1 \le K \le 1\;000\;000$)

경로는 $N$개의 세트로 주어집니다. 하나의 세트는 동서남북 (E, W, S, N) 중 하나의 방향과 그 방향으로 이동하는 횟수 $b$로 주어집니다. ($1 \le b \le 1000$)

### 출력

문제의 답 $x$를 출력합니다. 그러한 $x$가 존재하지 않는다면 `-1`을 출력합니다.

## 문제 풀이

{{% details title="스포일러" closed="true" %}}

$x$를 고정시켰을 때 최선의 전략을 생각해 보면 다음과 같습니다.

* 작물이 없는 칸에 진입했다면 작물을 심습니다.
* 작물이 완전히 자랐다면 수확하고 새로 작물을 심습니다. 그렇지 않다면 아무것도 하지 않고 그대로 둡니다.

이동할 수 있는 좌표의 범위가 가로 세로로 최대 100만이므로, 해시맵을 이용하여 시뮬레이션을 진행할 수 있고, $x$가 감소하면 반드시 이득임을 보일 수 있으므로 $x$에 대해 이분 탐색을 하여 풀 수 있습니다.

그런데 이대로 짜면 TLE를 받을 수 있고, 해시맵 사용을 최적화 (정수 2개로 이루어진 해시 키를 정수 1개로 변환, 또는 해시함수를 변경하거나 `gp_hash_table` 등의 다른 구현체 사용) 하거나,
여러 번 방문하는 칸들의 방문 시점들을 모두 기록한 뒤 리스트에 저장하여 이를 이용하여 시뮬레이션을 돌리는 등의 변경이 필요합니다.

{{% /details %}}
