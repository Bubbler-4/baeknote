---
params:
  boj: 26249
  bojTitle: Long Nim
---

## 문제 내용

마지막 돌을 가져간 사람이 승리하는 님 게임에서, 두 사람이 최선의 선택을 할 때 누가 이기는지는 잘 알려져 있습니다.

이제 지는 사람은 턴 수를 최대화하고자 하고, 이기는 사람은 턴 수를 최소화하고자 합니다.
게임의 시작 상태가 주어질 때, 두 사람이 최선의 선택을 하면 게임이 끝나는 데 몇 턴이 걸리는지, 그리고 첫 번째 사람의 첫 번째 턴에서의 최선의 선택이 무엇인지 구하세요.

### 입력

첫 줄에는 돌 더미의 개수 $n$이 주어집니다. ($1 \le n \le 10^5$)

두 번째 줄에는 각 더미의 돌의 개수 $a_1, a_2, \cdots, a_n$이 주어집니다. ($1 \le a_i \le 10^{12}$)

### 출력

첫 줄에는 두 사람이 최선의 선택을 할 때 몇 턴이 걸리는지를 출력합니다.

두 번째 줄에는 첫 번째 사람이 첫 번째 턴에 어느 더미에서 돌을 몇 개 가져가는 것이 최선인지를 더미의 번호, 돌의 개수 순으로 출력합니다.
최선의 선택이 여러 가지라면 그 중 아무거나 하나를 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저 첫 플레이어가 지는 경우부터 생각합니다. 첫 플레이어가 어떤 더미에서 돌을 한 개 빼서 상대 플레이어도 돌을 한 개만 뺄 수 있게 만들 수 있을까요?

먼저 가장 낮은 자리의 비트 (1의 비트)가 1인 더미가 있다고 가정하면, 그러한 더미는 적어도 두 개 있습니다. 그러면 첫 플레이어가 이러한 더미에서 1개를 빼는 것은 1을 XOR하는 것과 같고,
두 번째 플레이어는 다시 1을 XOR하여야 하므로 1의 비트가 1인 다른 더미에서 1개를 빼는 방법밖에 없습니다.

그러한 더미가 없다면 어떨까요? 모든 더미 중에서 가장 작은 $k$에 대해 $2^k$의 비트가 1인 더미 두 개를 생각합니다. 이러한 더미에서 1을 빼면 2진수 $1111 \cdots 1$ (1이 $k+1$개)을 XOR한 것과 같아집니다.
이제 상대는 같은 수를 XOR하여야 하는데, 이 수를 XOR하여 더 작은 값으로 만들 수 있는 더미는 $2^k$의 비트가 1인 더미뿐입니다. 방금 첫 플레이어가 1을 뺀 더미는 $2^k$의 비트가 더 이상 1이 아니고,
$2^k$의 비트가 1인 다른 더미는 2진수로 $\cdots 1000 \cdots 0$이므로 여기에 해당 수를 XOR한 결과는 1을 뺀 것과 동일합니다.

따라서 첫 플레이어가 지는 경우라면, 모든 더미 중에서 가장 낮은 비트가 켜져 있는 더미를 하나 골라 1을 빼는 것이 최선이고, 이를 반복하는 것으로 턴 수를 $\sum a_i$로 만들 수 있습니다.

이제 첫 플레이어가 이기는 경우, 이 플레이어는 항상 이기는 플레이를 하면서 턴 수를 최소화해야 합니다. 일단 첫 턴이 지나면 상대는 무조건 위의 플레이를 할 것이므로, 무조건 첫 턴에 가장 많은 돌을 제거해야 합니다.
따라서 XOR을 0으로 만드는 모든 방법 중에서 돌을 가장 많이 제거하는 방법을 출력하면 됩니다.

{{< /details >}}
