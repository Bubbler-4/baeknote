---
params:
  boj: 26477
  bojTitle: 最大公約数
---

## 문제 내용

양의 정수 $M$과 $A$가 주어집니다. 다음의 조건을 모두 충족하는 정수 $x$의 개수를 구하세요.

* $1 \le x < M$
* $M$과 $x$는 서로소입니다.
* $M$과 $A$의 최대공약수를 $g$라고 할 때, $Ax \equiv g (\bmod M)$입니다.

### 입력

입력은 여러 개의 테스트 케이스로 이루어져 있으며, 마지막 줄에는 `0 0`이 주어집니다.

각 테스트 케이스에 대해, $M$과 $A$가 한 줄에 주어집니다. ($2 \le M \le 10^{12}$, $1 \le A < M$)

### 출력

각 테스트 케이스에 대해, 문제의 정답을 한 줄에 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저, $Ax \equiv g (\bmod M)$을 충족하는 가장 작은 양의 정수를 $X$라고 합시다. 그리고 $A = gA'$, $M = gM'$으로 둡니다.
그러면 문제의 조건을 충족하는 1 이상 $M$ 미만의 모든 $x$의 값은 $X + iM'$ ($0 \le i < g$)의 형태가 되며, 그 중에서 $gM'$과 서로소인 것의 개수를 구하는 문제가 됩니다.

$A'X \equiv 1 (\bmod M')$이므로 $\gcd(X, M') = 1$이고, 따라서 $\gcd(X + iM', M') = 1$입니다. 그러므로 $\gcd(X + iM', gM') = \gcd(X + iM', g)$로 단순화할 수 있습니다.

그런데 $g$와 $M'$의 관계는 아직 모릅니다. 따라서 $M'$과 $g$가 서로소가 아닐 수도 있습니다 (ex: 예제의 3번째 입력).
$M'$과 $g$의 어떤 공통 소인수 $p$에 대해, $p$는 $M'$의 약수이므로 $X$는 $p$의 배수가 아닙니다. 따라서 $\gcd(X + iM', g) = \gcd(X + iM', \frac{g}{p})$가 되고,
이는 $M'$과 $\frac{g}{p_1^{e_1} p_2^{e_2} \cdots}$의 공통 소인수가 모두 없어질 때까지 반복할 수 있습니다.

그 결과로 얻는 $\frac{g}{p_1^{e_1} p_2^{e_2} \cdots}$의 값을 $g'$라고 하면, 이제 $\gcd(M', g') = 1$이므로 $X + iM' \bmod g'$은 $0 \le i < g'$에 대해 모두 서로 다른 값을 가집니다.
따라서 이 범위 내에서 $g'$와 서로소인 $X + iM'$의 개수는 $\varphi(g')$이고, 이 구간이 $\frac{g}{g'}$번 반복되므로 문제의 정답은 $\frac{g}{g'} \varphi(g')$입니다.

{{< /details >}}
