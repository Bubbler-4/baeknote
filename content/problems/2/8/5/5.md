---
params:
  boj: 2855
  bojTitle: 흥미로운 수열
---

## 문제 내용

생략

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저 각각의 인덱스에서 시작하여 오른쪽으로 합이 $S$ 이하인 가장 긴 구간과 왼쪽으로 합이 $S$ 이하인 가장 긴 구간을 구합니다. 이는 누적 합과 이분 탐색, 또는 투 포인터로 구할 수 있습니다.

각각의 인덱스에서 양쪽 길이의 최솟값을 취하면 각 지점을 중심으로 하는 가장 긴 흥미로운 수열의 길이를 구할 수 있습니다.

이제 이것을 시작점 기준으로 바꿔야 합니다. 길이가 짝수인 구간의 중심이라는 표현이 모호하므로, 오른쪽 구간의 맨 왼쪽 원소를 중심이라고 하겠습니다.
그러면, 중심이 $i$이고 길이가 $2k$인 흥미로운 구간은 $[i-k, i+k)$의 범위를 갖게 되고, 같은 중심을 가지고 길이가 작은 모든 구간 또한 흥미로운 구간이므로, 다음과 같은 구간 쿼리 문제가 됩니다.

* 모든 원소가 0인 길이 $N$의 수열에서 시작합니다.
* 각 인덱스 $i$에 대해 그 인덱스를 중심으로 갖는 흥미로운 구간의 최대 길이가 $2k$일 때, 인덱스 $i-k, i-k+1, \cdots, i-1$을 각각 $k, k-1, \cdots, 1$과 max를 취한 값으로 업데이트합니다.
* 모든 업데이트가 끝난 후에 모든 원소의 값을 출력합니다.

이 문제는 다음과 같이 바꿀 수 있습니다.

* 시작하는 길이 $N$의 수열을 $1, 2, \cdots, N$으로 바꿉니다.
* 업데이트를 인덱스 $i-k$부터 수열의 끝까지에 대해 $i$와 max를 취하는 것으로 바꿉니다.
* 그 결과의 수열에서 순서대로 $1, 2, \cdots, N$을 뺀 값을 출력합니다.

이제 구간 max 연산이 모두 수열의 끝까지로 바뀌었으므로, 세그먼트 트리를 써도 되지만 다른 여러 방법으로도 풀 수 있습니다.

* 업데이트 쿼리들을 시작점이 증가하는 순으로 정렬하고, 1번 원소부터 순서대로 보면서 그 원소에 영향을 주는 모든 쿼리들 중 최댓값으로 바꿉니다.
* 업데이트 쿼리들을 시작점이 증가하는 순으로 정렬하고, 쿼리의 값이 증가하는 쿼리들만 남깁니다. 남은 쿼리들을 역순으로 보면서 결과 배열을 채워 줍니다.

{{< /details >}}
