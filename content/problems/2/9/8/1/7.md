---
params:
  boj: 29817
  bojTitle: 주식을 안전하게 (Hard)
---

## 문제 내용

길이 $p$의 수열 $M_0, M_1, \cdots, M_{p-1}$이 주어집니다. $i \ge 1$에 대해 $D_i = M_i - M_{i-1}$이라고 할 때, 상수 $c$에 대해 다음의 식이 성립하도록 수열 $M$을 연장하려고 합니다.

$$
D_n + c \times D_{n-1} + \cdots + c^{p-1} \times D_{n+1-p} = 0
$$

이때 $M_k$를 $10^9+7$로 나누었을 때의 음이 아닌 나머지를 구하세요.

### 입력

첫 줄에 $p$, $c$, $k$가 주어집니다. ($2 \le p \le 100$, $1 \le c \le 100$, $p \le k \le 10^{18}$

다음 줄에 $M_0, M_1, \cdots, M_{p-1}$이 주어집니다. ($-10^8 \le M_i \le 10^8$)

### 출력

문제의 정답을 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

$D_i$에 대한 식을 $M_i$에 대한 식으로 치환한 뒤 정리하면 $M_n$에 대한 길이 $p$의 선형 재귀식을 얻을 수 있습니다. $p$는 100 이하이므로 행렬 거듭제곱을 이용하여 $k$번째 원소를 구할 수 있습니다.

{{< /details >}}
