---
params:
  boj: 30668
  bojTitle: Good arrays
---

## 문제 내용

$n$개의 양의 정수로 이루어진 배열 $\{a_1, a_2, \cdots, a_n\}$에서 $1 \le i \le n-1$에 대해 $a_i$가 $a_{i+1}$의 배수라면 이 배열을 **좋은 배열**이라고 합니다.

$c$ 이하의 양의 정수로 이루어진 길이 $n$의 좋은 배열의 개수를 구하세요.

### 입력

첫 줄에 $n$과 $c$의 값이 주어집니다. ($1 \le n, c \le 5 \times 10^7$)

### 출력

문제의 정답을 $998\;244\;353$으로 나눈 나머지를 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저, 양의 정수 $x$로 시작하는 배열의 개수를 생각해 봅시다. $x$의 소인수 $p$에 대해, 배열의 각 수에서 $p$의 지수를 나열하면 이것이 증가 수열이 되어야 함을 알 수 있으며, 이러한 소인수가 여러 개라면 각각 독립입니다.

그리고 $x$의 $p$의 지수가 $e$일 때, 이러한 지수의 수열은 반드시 $e$로 끝나야 하므로 그러한 수열의 개수는 ${{n+e-1}\choose{e}}$와 같고, 이것이 각각의 $p$에 대해 독립이므로 이러한 값들을 모두 곱한 것이 답이 됩니다. 이 답의 값을 $f(x)$라고 합시다.

이제 문제는 $1 \le x \le c$에 대해 $f(x)$의 합을 효율적으로 구하는 것입니다.

$c$의 제한이 너무 크므로 linear sieve를 쓰지 않으면 어떻게 짜도 TLE를 받을 것으로 보입니다. Linear sieve에 대해서는 [CP-Algorithms](https://cp-algorithms.com/algebra/prime-sieve-linear.html)를 참고할 수 있습니다.

Linear sieve의 가장 중요한 요소는 현재 처리하고 있는 값 $x$의 최소 소인수가 $p$일 때, $p$ 이하의 모든 소수 $q$에 대해 $qx$의 최소 소인수를 처리하는 것입니다.
이를 응용하여, $f(x)$의 값과 $x$에서 $p$의 지수 $e$를 알 때 $f(qx)$의 값, $qx$의 최소 소인수의 지수 $e'$를 다음과 같이 구할 수 있습니다.

* $f(px) = f(x) \div {{n+e-1}\choose{e}} \times {{n+e}\choose{e+1}} = f(x) \times \frac{n+e}{e+1}$
* $px$의 최소 소인수의 지수 $= e + 1$
* $q < p$일 때, $f(qx) = f(x) \times n$
* $qx$의 최소 소인수의 지수 $= 1$

이제 구한 $f(x)$들을 모두 더하여 출력하면 됩니다.

{{< /details >}}
