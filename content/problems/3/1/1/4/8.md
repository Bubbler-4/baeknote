---
params:
  boj: 31148
  bojTitle: Counting Phenomenal Arrays
---

## 문제 내용

양의 정수로 이루어진 배열 $[a_1, a_2, \cdots, a_k]$의 모든 원소들의 합과 모든 원소들의 곱이 서로 같으면, 이 배열을 **phenomenal array**라고 합니다.

$f(n)$을 길이 $n$의 서로 다른 phenomenal array의 개수로 정의합니다. 이러한 개수는 임의의 $n \ge 2$에 대해 유한함을 증명할 수 있습니다.
두 배열에서 적어도 하나의 인덱스의 값이 서로 다르면 두 배열은 다른 배열입니다.

$n$과 소수 $p$가 주어질 때, $f(2) \bmod p, f(3) \bmod p, \cdots, f(n) \bmod p$의 값을 모두 구하세요.

### 입력

$n$과 $p$가 한 줄에 주어집니다. ($2 \le n \le 200\;000$, $10^8 \le p \le 10^9$, $p$는 소수)

### 출력

문제의 정답을 순서대로 한 줄에 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저, 순서와 상관없이 모든 배열을 구할 수 있으면, 그 배열의 서로 다른 원소들의 개수에 대한 multinomial을 구하여 답에 더해주면 됩니다.

이를 위해서, 각 배열에서 1을 모두 제외한 것을 생각합니다. 그러면 임의의 배열에 `곱 - 합` 만큼의 1을 추가하면 phenomenal array를 얻을 수 있습니다.
이제 이 "임의의 배열" 중에서 전체 배열의 길이가 $n$ 이하인 것들을 모두 찾으면 됩니다. 전체 곱이 약 20만 이하가 되려면 곱해지는 2 이상의 수의 개수는 17 이하이고
각각의 곱해지는 수가 커질수록 점점 탐색 깊이가 얕아지기 때문에, 이러한 배열의 총 개수는 크지 않을 것이라고 예상할 수 있습니다. 실제로 계산 시 약 600만 개 정도가 나옵니다.

이를 조금 더 효율적으로 계산하기 위해서는, 실제 수들의 배열을 넘기지 않고 필요한 정보만을 전달하는 방법이 있습니다. 여기서 필요한 정보는 (마지막 수, 마지막 수의 개수, 전체 개수, 합, 곱, multinomial의 분모)
면 충분합니다.

{{< /details >}}
