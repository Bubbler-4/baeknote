---
params:
  boj: 31294
  bojTitle: Convolution
---

## 문제 내용

길이 $2^n$의 배열 $f$와 $g$가 주어집니다. 다음의 식으로 정의되는 배열 $h$를 구하세요. 식에서 $j | k$는 $j$와 $k$의 bitwise OR를 의미합니다.

$$
h(i) = \sum_{j|k = i} f(j) g(k)
$$

### 입력

첫 줄에는 $n$의 값과 테스트 케이스의 개수 $t$가 주어집니다. ($1 \le n \le 16$, $1 \le t \le 100$)

그 다음 줄에는 각 테스트 케이스를 생성할 파라미터 값 $a$와 $b$가 주어집니다. ($1 \le a, b \le 10^9$)

$a$와 $b$의 값을 이용하는 PRNG 함수 `rand16`을 다음과 같이 정의합시다.

```
state = 0
def rand16():
    global state
    state = (state * a + b) % (2 ** 32)
    return state >> 16
```

그러면 각각의 테스트 케이스에 대해, 먼저 `rand16`을 $2^n$번 호출하여 순서대로 배열 $f$의 원소를 얻고, 그 다음 `rand16`을 $2^n$번 호출하여 순서대로 배열 $g$의 원소를 얻어야 합니다.
`state`는 테스트 케이스 사이에 초기화되지 않습니다.

### 출력

각 테스트 케이스에 대해, $(\sum_{i = 0}{2^n-1} h(i) \times (i+1)) \bmod 2^{32}$를 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

OR convolution의 기본 문제입니다. 이 문제는 다음의 과정을 거쳐서 풀 수 있습니다.

* 먼저 배열 $f$와 $g$에 SOS DP를 합니다. 그러면 $f'(i)$는 $i$의 1 비트의 부분집합을 1로 갖는 인덱스 $j$에 대한 $f(j)$의 합입니다.
* 그 다음, 각각의 $i$에 대해 $f(i)g(i)$를 구하여 $h'(i)$로 둡니다. 이러한 $h'(i)$의 값은 $j|k$가 $i$의 1 비트의 부분집합이 되는 $j$와 $k$에 대해 $f(j) g(k)$의 합입니다.
* 마지막으로, 배열 $h'$에 비트 포함배제를 하면 $h$를 얻을 수 있습니다.

{{< /details >}}
