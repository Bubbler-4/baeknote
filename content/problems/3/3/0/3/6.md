---
params:
  boj: 33036
  bojTitle: Judicious Watching
---

## 문제 내용

당신은 $n$개의 과제를 해야 합니다. 각각의 과제에는 소요 시간과 마감 시한이 정해져 있습니다.

그와 동시에 당신은 $m$편의 드라마도 보고 싶습니다. 하지만 다음과 같은 제약 사항이 있습니다.

* 당신은 임의의 한 시점에 과제를 하는 행동과 드라마를 보는 행동을 동시에 할 수 없습니다.
* 어떤 과제를 하거나 어떤 드라마 회차를 보기 시작하면, 그것이 끝나기 전에 다른 행동을 할 수 없습니다.
* 과제는 원하는 순서대로 할 수 있지만, 드라마는 에피소드 순서대로 봐야 합니다.

$q$개의 시점이 주어질 때, 각각에 대해 그 시점까지 당신이 끝까지 본 드라마 회차의 최대 개수를 출력하세요.

### 입력

첫 줄에는 테스트 케이스의 개수 $T$가 주어집니다. ($1 \le T \le 1000$)

각 테스트 케이스의 첫 줄에는 $n$, $m$, $q$가 주어집니다. ($1 \le n, m, q \le 200\;000$)

두 번째 줄에는 $n$개의 값 $a_i$가 주어집니다. 이는 각각의 과제의 소요 시간을 나타냅니다. ($1 \le a_i \le 10^9$)

세 번째 줄에는 $n$개의 값 $d_i$가 주어집니다. 이는 각각의 과제의 마감 시한을 나타냅니다. ($1 \le d_i \le 10^{15}$)

네 번째 줄에는 $m$개의 값 $l_j$가 주어집니다. 이는 각각의 드라마 회차의 길이를 나타냅니다. ($1 \le l_j \le 10^9$)

다섯 번째 줄에는 $q$개의 값 $t_k$가 주어집니다. 이는 당신이 답해야 할 시점들을 나타냅니다. ($1 \le t_k \le 10^{15}$)

각 테스트 케이스의 $n$의 합, $m$의 합, $q$의 합은 각각 $200\;000$을 초과하지 않습니다.

모든 과제를 각각의 마감 시한 내에 모두 완료할 수 있음이 보장됩니다.

### 출력

각 테스트 케이스에 대해, 각각의 시점에 대한 답을 한 줄에 공백으로 구분하여 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

마지막 마감 시한까지, 모든 과제를 마치는 데 필요한 시간은 고정입니다. 따라서 과제를 하는 시간을 제외하고 남는 시간 또한 고정입니다.
그 안에서 드라마를 최대한 빠른 시각에 보려면, 가능한 여유 시간을 최대한 앞에 가져야 하고, 그러려면 과제를 하는 시간을 최대한 뒤로 미뤄야 합니다.

이를 달성하기 위해서는 마감 시한 역순으로 보면서 추가되는 과제를 모두 가능한 한 늦게 배치하면 됩니다. 어떤 시점에 여러 개의 과제를 선택할 수 있는 경우는 어느 것을 먼저 선택하든 상관이 없습니다.
어떤 시점에 선택할 과제가 없는 경우에만 그때 비게 되는 최소 시간을 적어 둡니다. 이렇게 생기는 여유 시간은 앞으로 당길 수 없습니다.

이제 드라마를 앞에서부터 배치해야 합니다. 드라마 다음 편을 볼 만큼의 시간이 있다면 그 드라마를 배치합니다. 그렇지 않다면, 다음 여유 시간까지의 모든 과제를 앞으로 당겨서 여유 시간을 합칠 수 있습니다.
이를 반복하면 모든 드라마는 드라마의 누적 길이가 누적된 여유 시간과 일치하는 시점을 끝점으로 갖도록 볼 수 있게 됩니다.

각 시점에서 끝까지 본 드라마의 편 수는, 먼저 시점들을 정렬한 뒤 여유 시간 목록과 투 포인터를 하여 그 시점까지의 여유 시간을 계산한 뒤, 동시에 드라마의 길이들과 투 포인터를 하여 구할 수 있습니다.

{{< /details >}}
