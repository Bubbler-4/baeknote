---
params:
  boj: 33125
  bojTitle: X Aura
---

## 문제 내용

$R$행 $C$열의 격자의 각 칸에 정수가 쓰여 있습니다. 당신은 한 번 이동할 때 사방으로 이웃한 칸 중 하나로 이동할 수 있으며, 이때 페널티는 이전 칸의 값이 $h_1$, 다음 칸의 값이 $h_2$일 때
$(h_1 - h_2)^X$입니다. $X$는 홀수인 양의 정수입니다. 즉, 더 큰 수가 쓰여진 칸으로 이동할 때는 페널티가 감소합니다.

다음의 쿼리를 총 $Q$개 처리하세요.

* $(R_1, C_1)$에서 시작하여 $(R_2, C_2)$로 이동하려고 할 때, 페널티의 총합의 최솟값을 출력합니다. 이 값을 원하는 만큼 감소시킬 수 있으면 `INVALID`를 대신 출력합니다.

### 입력

첫 줄에는 $R$, $C$, $X$의 값이 주어집니다. ($1 \le R, C \le 1000$, $1 \le X \le 9$, $X$는 홀수)

다음 $R$줄에 걸쳐서 $R \times C$ 크기의 격자의 각 칸의 값이 공백 없이 주어집니다. 각 칸의 값은 0 이상 9 이하의 정수입니다.

다음 줄에는 $Q$가 주어지고, 다음 $Q$줄에는 각 쿼리가 $R_1$, $C_1$, $R_2$, $C_2$의 순으로 주어집니다.

### 출력

각 쿼리에 대해 정답을 한 줄에 하나씩 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

$2 \times 2$ 영역을 한 바퀴 도는 사이클을 단위 사이클이라고 합시다. 어떤 단위 사이클을 한 바퀴 돈 결과의 페널티가 0이 아니라면 이를 음이 되는 방향으로 원하는 횟수만큼 돌 수 있으므로
모든 쿼리의 결과는 INVALID가 됩니다. (시작과 끝 위치에 상관없이 그 사이클이 있는 곳으로 이동하면 되며, 이는 예제에도 주어져 있습니다.)

격자 위에서의 모든 사이클은 한 개 이상의 단위 사이클의 합성으로 나타낼 수 있으므로, 모든 단위 사이클의 페널티가 0이면 어떤 사이클을 선택하더라도 페널티가 0이 되며, 이 때는
아무 경로로 가더라도 같은 답을 내게 됩니다. 따라서 다음과 같은 방법이 있습니다.

* 각 칸에서 가로로 이동할 때의 페널티와 세로로 이동할 때의 페널티를 계산하여 가로, 세로 방향으로 각각 누적합을 해 놓고, 시작점에서 먼저 가로로 이동하고 다음 세로로 이동하는 페널티를 계산합니다.
* 격자 전체를 ㄹ자로 잘라서 편 뒤에 누적합을 하여 시작점과 끝점 사이의 페널티를 계산합니다.

{{< /details >}}
