---
params:
  boj: 33275
  bojTitle: 소소고금
---

## 문제 내용

생략

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저 $K$가 홀수인 경우를 생각해 봅시다. $0 \le i \le N$에 대해 첫 $i$개 글자를 제외한 수를 $K$로 나눈 나머지를 $r_i$라고 할 때, $i < j$이면서 $r_i = r_j$이면
두 suffix가 나타내는 수의 차이는 $S_i \cdots S_{j-1}$에 2의 거듭제곱을 곱한 것과 같고, 이것이 $K$의 배수이면 부분 문자열 $S_i \cdots S_{j-1}$ 또한 $K$의 배수입니다.
따라서 $r_i$들을 먼저 계산해 놓고, 앞에서부터 각각의 나머지의 개수를 세어 가면서 $r_i$와 같은 것의 개수를 더하는 것으로 답을 구할 수 있습니다.

$K$가 짝수라면 어떨까요? $K = 2^e p$ ($p$는 홀수)로 유일하게 나타낼 수 있습니다. 그러면 어떤 부분 문자열이 $K$의 배수인 것은 그 값이 $2^e$의 배수이면서 동시에 $p$의 배수인 것과 동치입니다.
길이가 $e$ 이상인 부분 문자열의 경우, 전자는 $e$개의 0으로 끝나는 것으로 판정할 수 있고, 후자는 홀수 $K$와 동일한 조건입니다.
따라서 두 개의 포인터를 간격 $e$를 두고 움직여가면서 오른쪽 포인터로는 0으로만 이루어진 suffix의 길이를 유지하고, 왼쪽 포인터로는 나머지의 개수를 세어가면서 동일하게 구하면 됩니다.

길이가 $e-1$ 이하인 부분 문자열은 $K$의 배수가 되려면 0으로만 이루어져야 합니다. 따라서 위의 투 포인터 코드에서 0으로만 이루어진 suffix의 길이를 보고 길이 $e-1$ 이하이면서 0으로만 이루어진 suffix의 개수를
추가로 더해주면 정답이 됩니다.

{{< /details >}}
