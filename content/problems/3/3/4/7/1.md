---
params:
  boj: 33471
  bojTitle: 대회 운영에 있어 제일 귀찮은 것은 무엇일까
---

## 문제 내용

생략

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

Z 알고리즘을 사용하면 각 인덱스 $i$에서 $S$와 $S[i..]$의 common prefix의 길이를 구할 수 있습니다.

일단 복사 연산을 한 번 수행하면 그 다음부터는 붙여넣기만 할 수 있으므로 복사할 prefix의 길이에 대해 답이 하나로 정해지고, 그 중 최적인 경우를 출력하면 됩니다.
복사한 prefix가 나타나는 위치가 여러 개라면 매번 가장 맨 앞에 등장하는 위치를 치환하는 것을 반복하는 것이 최적입니다.

복사할 prefix의 길이가 $l$이면, 그 prefix가 $S$에서 겹치지 않게 나타나는 횟수는 최대 $\frac{|S|}{l}$이므로, 각각의 suffix에서 길이 $l$의 prefix가 나타나는 첫 번째 위치를 빠르게 구할 수 있다면
harmonic number 공식에 의해 시간 내에 문제를 해결할 수 있습니다.

이러한 위치를 구하는 방법은 매우 많습니다. 예를 들어 구간 max의 sparse table을 만들어 놓고 그 위에서 이분탐색을 진행하는 방법 등이 있습니다.

{{< /details >}}
