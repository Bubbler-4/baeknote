---
params:
  boj: 33729
  bojTitle: Bessie's Function
---

## 문제 내용

1 이상 $N$ 이하의 정수를 정의역과 공역으로 갖는 함수 $f$가 있습니다. 이 함수는 각각의 입력에 대한 함숫값 $f(1), f(2), \cdots, f(N)$으로 정의됩니다.

당신은 $1 \le i \le N$에 대해 비용 $c_i$를 지불하고 $f(i)$의 값을 바꿀 수 있습니다.

함수 $f$가 모든 $x$에 대해 $f(f(x)) = f(x)$를 충족하게 하기 위해서 지불해야 하는 최소 비용을 출력하세요.

### 입력

첫 줄에 $N$이 주어집니다. ($1 \le N \le 200\;000$)

두 번째 줄에 $f(1), f(2), \cdots, f(N)$이 주어집니다.

세 번째 줄에 $c_1, c_2, \cdots, c_N$이 주어집니다. ($1 \le c_i \le 10^9$)

### 출력

문제의 정답을 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

먼저, 어떤 값의 함숫값을 바꿀 때는 $f(i) = i$로 바꾸는 것이 항상 이득입니다. 이미 $f(j) = i$인 $j$들에 대해서도 동시에 조건을 충족하게 할 수 있기 때문입니다.

또한 각각의 수에 대해 $x$에서 $f(x)$로 가는 유향 간선으로 정의되는 그래프를 생각하면, 이 그래프는 함수형 그래프이며, 각각의 간선에 대해 두 끝점 중 하나는 $f(x) = x$가 충족되게 해야 함을 알 수 있습니다.
따라서 이 문제는 각 간선의 양 끝점 중 하나를 반드시 색칠해야 한다는 조건 하에서 최소 비용 색칠을 구하는 문제가 됩니다.

함수형 그래프의 하나의 연결 요소는 하나의 사이클과 그 사이클에서 뻗어나오는 가지로 이루어져 있으므로, 사이클 위의 점의 색깔을 고정하고 나머지 부분에 대해 트리 DP를 해 보는 것으로 문제의 답을 구할 수 있습니다.
사이클이 하나의 정점으로 이루어져 있을 경우 그 정점은 이미 색칠된 것으로 처리해야 함(즉 색칠되어 있으면서 추가 비용을 지불하지 않음)에 유의합니다.

{{< /details >}}
