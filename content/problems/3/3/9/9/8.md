---
draft: true
params:
  boj: 33998
  bojTitle: 거의 같은 문자열
---

## 문제 내용

알파벳 소문자로 이루어진 문자열 $S$가 주어지고, **역시 알파벳 소문자로 이루어진** 문자열 $Q_i$가 주어집니다. 쿼리는 총 $M$개 주어집니다. ($1 \le N, M \le 10^5$)

각 쿼리 $Q_i$에 대해, 각 문자의 개수가 모두 $Q_i$와 같은 $S$의 부분 문자열의 개수를 구하세요. (모든 쿼리의 길이의 합 $\le 10^5$)

## 문제 풀이

{{% details title="스포일러" closed="true" %}}

먼저, 각 문자의 개수를 저장하는 롤링 해시를 떠올릴 수 있습니다. 그런데 모든 해싱 결과를 한 번에 저장하는 것은 $\mathcal{O} (N^2)$ 시간과 메모리가 필요하므로, 쿼리로 주어진 길이에 대해서만 저장을 시도할 수 있습니다.

쿼리가 모두 길이가 서로 다르려면 최악의 경우 $1, 2, 3, \cdots$의 형태가 되므로 $\mathcal{O} (N \sqrt{N})$ 시간에 모든 필요한 해싱을 완료할 수 있습니다.
단, 이러한 해싱 결과를 모두 저장해서 들고 있으려고 하면 메모리가 초과될 수 있으므로, 쿼리를 같은 길이인 것끼리 묶어서 처리하고 재활용이 필요 없는 해싱 결과는 지워 줍니다.

마지막으로, 쿼리의 길이가 $S$의 길이보다 긴 경우 인덱스 오류에 주의합니다.

{{% /details %}}
