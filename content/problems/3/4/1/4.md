---
params:
  boj: 3414
  bojTitle: Conservation
---

## 문제 내용

$n$개의 작업을 진행하려고 합니다. 각각의 작업은 두 개의 연구소 중 한 곳에서만 할 수 있으며, 몇몇 작업 간에는 선후 관계를 따라야 합니다. 이때 한 연구소에서 다른 연구소로 이동하는 횟수를 최소화하여 그 횟수를 출력하세요.
작업의 시작은 두 연구소 중 아무 곳에서 시작해도 됩니다.

### 입력

첫 줄에는 테스트 케이스의 개수 $T$가 주어집니다.

각 테스트 케이스에 대해, 첫 줄에는 작업의 개수 $n$과 선후 관계의 개수 $m$이 주어집니다. ($1 \le n \le 10^5$, $0 \le m \le 10^6$)

다음 줄에는 $n$개의 수가 주어지며, 이들은 각각 $i$번째 작업이 진행되어야 하는 연구소의 번호(1 또는 2)를 나타냅니다.

다음 $m$줄에는 선후 관계가 한 줄에 하나씩 주어집니다. `x y`는 작업 $x$가 끝나야 작업 $y$를 할 수 있다는 뜻입니다. ($1 \le x, y \le n$)

선후 관계를 모두 충족하면서 모든 작업을 끝낼 수 있는 입력만 주어집니다.

### 출력

각 테스트 케이스에 대해 문제의 답을 한 줄에 출력합니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

다음의 그리디 전략을 사용할 수 있습니다.

* 먼저 시작할 위치를 선택합니다.
* 각 연구소에 대해 그곳에서 당장 할 수 있는 작업을 모아 놓습니다.
* 현재 위치에서 당장 할 수 있는 작업을 모두 진행하고, 완료된 작업으로 인해 새로 할 수 있게 된 작업을 추가하는 것을 더 이상 할 것이 없을 때까지 반복하고, 반대쪽 연구소로 이동합니다.
* 이를 모든 작업이 완료될 때까지 반복합니다.

이 과정을 두 가지 가능한 시작 위치에 대해 반복하여 둘 중에서 이동 횟수가 적은 것을 고르면 됩니다.

{{< /details >}}
