---
params:
  boj: 35065
  bojTitle: 움직이지 않고 여행하는 법
---

## 문제 내용

$N$개의 정점을 갖는 무방향 무가중치 완전 그래프에서 $M$개의 간선을 제거했을 때, 1번 정점에서 각 정점까지의 최단 경로의 길이와 그 길이를 갖는 경로의 개수를 구하세요.

### 입력

첫 줄에는 $N$과 $M$이 주어집니다. ($2 \le N \le 200\;000$, $0 \le M \le 500\;000$)

다음 줄부터 각 줄에는 $M$개의 간선의 양 끝점 $u_i$와 $v_i$가 주어집니다. ($u_i \neq v_i$) $(u, v)$와 $(v, u)$는 같은 간선이며, 중복된 간선은 주어지지 않습니다.

### 출력

$1 \le i \le N$에 대해, $i$번 정점까지의 최단 경로의 길이, 그리고 그러한 최단 경로의 개수를 $998\;244\;353$으로 나눈 나머지를 순서대로 한 줄에 출력합니다.

1번 정점에서 1번 정점까지의 최단 경로의 길이는 0이고, 그러한 경로의 개수는 1입니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

다음의 방법으로 BFS를 돌릴 수 있습니다.

* 거리 $d$인 정점들의 목록(길이 $k$)과 아직 방문하지 않은 정점들의 목록을 기록해 둡니다.
* 거리 $d$인 정점들에서 anti-이웃들의 목록을 확인하여, 그 중 아직 방문하지 않은 정점에 카운트를 1 추가합니다.
* 아직 방문하지 않은 정점 $x$가 카운트가 $k$이면 거리 $d+1$이 아닙니다. 나머지 모든 정점은 거리 $d+1$이 됩니다.
* 거리 $d+1$인 정점에 대해 그 정점의 거리 $d$인 이웃까지 오는 방법의 수를 모두 더합니다.

마지막 단계에서 거리 $d$인 이웃까지 오는 방법의 수는 거리 $d$인 모든 정점까지 오는 방법의 수를 모두 더해놓은 뒤에 anti-이웃의 방법의 수의 합을 빼 주면 됩니다.
이렇게 하면 anti-이웃을 확인하는 모든 과정은 총 $\mathcal{O}(M)$에 수행할 수 있습니다. (모든 정점에서의 out-간선을 각각 상수번만 확인하기 때문)

모든 $d$에 대해서 아직 방문하지 않은 정점들의 목록의 길이의 합은 각 정점들의 최단거리의 합과 같고 (각 정점이 최단거리 번만큼 등장하기 때문),
각 정점들의 최단거리는 그 정점의 anti-이웃의 개수 + 1 이하이므로, 그 합은 $\mathcal{O}(M+N)$입니다.
단, 이미 처리된 정점을 포함하여 모든 정점을 확인하는 과정이 한 번이라도 있으면 $\mathcal{O}(N \sqrt{M})$이 되어버리므로 주의합니다.

{{< /details >}}
