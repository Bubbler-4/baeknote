---
params:
  boj: 35153
  bojTitle: 시니어 개발자 동우의 직행 취업일기
---

## 문제 내용

생략

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

다음과 같은 3층의 트리를 생각합니다.

* 루트 정점이 하나 있고, 그 밑에 $m$개의 자식이 있고, 이들 각각에게 $a_1, a_2, \cdots, a_m$개의 자식이 있는 트리

그러면 적어도 두 개의 $a_i$가 양수일 때 트리의 지름의 길이는 4가 되고, 그러한 정점의 쌍의 개수는 $\sum_{1 \le i < j \le m} a_i a_j$가 됩니다.

여기서부터 다양한 방법으로 문제를 풀 수 있습니다.

{{< /details >}}

{{< details title="bubbler의 풀이" closed="true" >}}

$[a_1, \cdots, a_m] = [a, 1, 1, \cdots, 1, 2, 2, \cdots, 2]$의 형태를 생각합니다. 이때 1의 개수를 $x$, 2의 개수를 $y$라고 합시다.

그러면 이 트리의 지름의 개수는 $ax + 2ay + 2xy + \frac{x(x-1)}{2} + 2y(y-1)$입니다.
여기서 $z = x + 2y$로 정의하고 위 값이 $n$과 같다고 둔 뒤 식을 정리하면 $z^2 + (2a-1)z - (2n+2y) = 0$을 얻습니다.

이 이차방정식이 정수해를 갖는 음이 아닌 $y$들 중에서 최소가 되도록 $y$와 음이 아닌 $z$를 이분 탐색으로 구할 수 있는데, 이때 $x = z - 2y$가 음수일 수 있습니다.
이를 피하기 위해 $a$를 0부터 증가시켜 가면서 $x$가 음수가 아니게 될 때까지 시도해보면 답을 얻을 수 있습니다.

$2n$ 이상의 $z(z-1)$꼴의 최소 정수를 $k$라고 하면, 일반적인 $a$에 대해 $z(z+2a-1)$꼴의 최소 정수는 $k - a(a-1)$이 됩니다. $z(z-1)$꼴의 이웃한 두 정수의 차이는 $2z$인데, $a$를 바꿀 때
조건을 충족하는 최소 정수는 대략 $\sqrt{z}$의 간격으로 움직이므로 적당히 큰 $n$에 대해서는 반드시 답을 구할 수 있음을 확신할 수 있습니다.
실제로 코드를 짜서 돌려 보면 $n = 1$부터 모든 작은 $n$에 대해서도 올바른 답이 얻어지며, 198B 숏코딩 풀이가 이를 사용합니다.

{{< /details >}}

{{< details title="그 외의 풀이" closed="true" >}}

* $m = 3$으로 두고 $n = xy + yz + zx$를 푸는 풀이가 가능합니다. 이 방정식은 $n$이 특정한 작은 수 몇 개일 때를 제외하면 해가 존재함이 알려져 있으나, 적당한 개수의 정점을 얻을 수 있음은 실험적으로만 알 수 있습니다.
* $[a_1, \cdots, a_m] = [x, y, z, 1, 1, \cdots, 1]$로 두고, 이때 $1$의 개수를 $a$라고 하고 $a + x + y + z = s$라고 하면, $n = \frac{s(s-1)}{2} - \frac{x(x-1)}{2} - \frac{y(y-1)}{2} - \frac{z(z-1)}{2}$
  가 되고, $s$를 고정한 뒤 남는 차이를 세 개의 삼각수의 합으로 나타내어 풀 수 있습니다.

{{< /details >}}
