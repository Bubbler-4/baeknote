---
params:
  boj: 3835
  bojTitle: Alphabet Soup
---

## 문제 내용

원 위의 $P$개의 자리에 각각 $S$종류의 글자 중 하나를 놓으려고 합니다. 글자는 중복될 수 있습니다. 원을 회전시켰을 때 같은 위치에 같은 글자가 오게 만들 수 있다면 한 가지 방법으로 셀 때, 글자를 놓는 방법의 수를 구하세요.

### 입력

입력은 여러 개의 테스트 케이스로 이루어져 있으며, `-1 -1`로 종료됩니다. 각 테스트 케이스 뒤에는 빈 줄이 하나 있습니다.

각 테스트 케이스의 첫 줄에는 $S$와 $P$의 값이 주어집니다. ($2 \le S \le 1000$, $1 \le P$)

다음 $P$줄에는 각 자리의 위치가 millidegree 단위로 주어집니다. 각 자리의 위치는 $0$ 이상 $360\;000$ 미만의 정수이며, 서로 다릅니다.

### 출력

각 테스트 케이스에 대해 문제의 답을 $100\;000\;007$로 나눈 나머지를 출력합니다. $100\;000\;007$은 소수입니다.

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

문제에서 요구하는 답은 번사이드의 보조정리로 구할 수 있습니다. $i$ millidegree만큼 회전했을 때 자리가 겹쳐지는 경우에 대해, 그만큼 회전했을 때에 그 자리에 동일한 글자가 오는 경우의 수를 세어 평균을 내면 됩니다.

$i$ millidegree만큼 회전했을 때 모든 자리가 겹친다면, 그러한 회전을 반복하여 겹쳐지는 $w = \frac{360\;000}{\gcd(360\;000, i)}$개의 자리에 모두 같은 글자가 와야 하며, 이를 충족하는 경우의 수는 $S^{\frac{P}{w}}$입니다.

이제 자리들을 회전했을 때 기존의 자리들과 완전히 겹쳐지는 각도들을 모두 구하면 문제의 정답을 구할 수 있습니다. 이는 KMP나 해싱으로 구해도 되고, $360\;000$의 약수들을 모두 체크해도 된다고 합니다.

{{< /details >}}
