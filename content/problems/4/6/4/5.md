---
params:
  boj: 4645
  bojTitle: 힐베르트 곡선
---

## 문제 내용

생략

## 문제 풀이

{{< details title="스포일러" closed="true" >}}

이 문제는 탑다운 재귀 DP로 풀 수 있습니다. 먼저 다음과 같은 관찰을 합니다.

* $n$차 힐베르트 곡선이 주어진 가로선과 교차하는 횟수는 $n-1$차 힐베르트 곡선 4개가 가로선과 교차하는 횟수의 총합입니다.
* 이때 재귀한 결과 가로선이 세로선으로 바뀔 수 있으므로, 결국 가로선과 세로선 모두를 해결할 수 있는 방법을 찾아야 합니다.
* 가로선의 분할 중에서 양 끝을 제외한 모든 구간은 $k$차 힐베르트 곡선까지 재귀했을 때 $2^k$의 길이를 가지며, 그러한 선분의 가능한 위치는 4가지(돌리고 뒤집기)밖에 없습니다.
* 따라서, 재귀 계산의 결과들을 캐싱해 두면 $\mathcal{O}(n)$개의 계산값만을 가지고 원래 문제의 답을 구할 수 있습니다.

이제 다음과 같은 재귀 구현을 잘 하면 됩니다.

* 입력에서 $y = 0$ 또는 $y = 2^n$이면 답은 0입니다. 입력에서 $y$가 다른 값이라면, 다음 줄에 의해 이 base case에는 도달하지 않습니다.
* 가로줄의 $y = 2^{n-1}$이면, 재귀를 멈추고 $n$단계에서 추가되는 세로선 두 개 중에서 교차하는 것의 개수를 세어 리턴합니다.
* 세로줄의 $x = 2^{n-1}$이면, 마찬가지로 재귀를 멈추고 추가되는 가로선 1개가 교차하는지 판단하여 리턴합니다.
* 그 외의 경우, 가로줄이나 세로줄이 4개 사분면 중 하나에 완전히 포함되면 그쪽으로 재귀하고, 그렇지 않다면 두 개로 나누어 재귀합니다. 재귀할 때 위쪽 두 영역을 회전하거나 뒤집어야 하는데, 그때
  좌표 변화에 유의합니다.

{{< /details >}}
